!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("constants"),require("create-hash"),require("buffer"),require("assert")):"function"==typeof define&&define.amd?define(["constants","create-hash","buffer","assert"],e):(t=t||self,function(){var r=t["mini-rsa"],n=t["mini-rsa"]=e(t.constants,t.createHash,t.buffer,t.assert);n.noConflict=function(){return t["mini-rsa"]=r,n}}())}(this,function(t,e,r,n){"use strict";function i(t,e){return t(e={exports:{}},e.exports),e.exports}t=t&&t.hasOwnProperty("default")?t.default:t,e=e&&e.hasOwnProperty("default")?e.default:e,r=r&&r.hasOwnProperty("default")?r.default:r,n=n&&n.hasOwnProperty("default")?n.default:n;var o=i(function(t){var e=t.exports={version:"2.6.9"};"number"==typeof __e&&(__e=e)}),s=(o.version,o.JSON||(o.JSON={stringify:JSON.stringify})),f=function(t){return s.stringify.apply(s,arguments)},h=i(function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)}),u=function(t,e,r){if(function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!")}(t),void 0===e)return t;switch(r){case 1:return function(r){return t.call(e,r)};case 2:return function(r,n){return t.call(e,r,n)};case 3:return function(r,n,i){return t.call(e,r,n,i)}}return function(){return t.apply(e,arguments)}},a=function(t){return"object"==typeof t?null!==t:"function"==typeof t},p=function(t){if(!a(t))throw TypeError(t+" is not an object!");return t},c=function(t){try{return!!t()}catch(t){return!0}},l=!c(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),y=h.document,m=a(y)&&a(y.createElement),g=function(t){return m?y.createElement(t):{}},d=!l&&!c(function(){return 7!=Object.defineProperty(g("div"),"a",{get:function(){return 7}}).a}),v=function(t,e){if(!a(t))return t;var r,n;if(e&&"function"==typeof(r=t.toString)&&!a(n=r.call(t)))return n;if("function"==typeof(r=t.valueOf)&&!a(n=r.call(t)))return n;if(!e&&"function"==typeof(r=t.toString)&&!a(n=r.call(t)))return n;throw TypeError("Can't convert object to primitive value")},b=Object.defineProperty,S={f:l?Object.defineProperty:function(t,e,r){if(p(t),e=v(e,!0),p(r),d)try{return b(t,e,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[e]=r.value),t}},w=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},B=l?function(t,e,r){return S.f(t,e,w(1,r))}:function(t,e,r){return t[e]=r,t},E={}.hasOwnProperty,T=function(t,e){return E.call(t,e)},_=function(t,e,r){var n,i,s,f=t&_.F,a=t&_.G,p=t&_.S,c=t&_.P,l=t&_.B,y=t&_.W,m=a?o:o[e]||(o[e]={}),g=m.prototype,d=a?h:p?h[e]:(h[e]||{}).prototype;for(n in a&&(r=e),r)(i=!f&&d&&void 0!==d[n])&&T(m,n)||(s=i?d[n]:r[n],m[n]=a&&"function"!=typeof d[n]?r[n]:l&&i?u(s,h):y&&d[n]==s?function(t){var e=function(e,r,n){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,r)}return new t(e,r,n)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(s):c&&"function"==typeof s?u(Function.call,s):s,c&&((m.virtual||(m.virtual={}))[n]=s,t&_.R&&g&&!g[n]&&B(g,n,s)))};_.F=1,_.G=2,_.S=4,_.P=8,_.B=16,_.W=32,_.U=64,_.R=128;var O=_;O(O.S+O.F*!l,"Object",{defineProperty:S.f});var k=o.Object,x=function(t,e,r){return k.defineProperty(t,e,r)},P=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t},I="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff",D="["+I+"]",L=RegExp("^"+D+D+"*"),A=RegExp(D+D+"*$"),N=function(t,e,r){var n={},i=c(function(){return!!I[t]()||"​"!="​"[t]()}),o=n[t]=i?e(R):I[t];r&&(n[r]=o),O(O.P+O.F*i,"String",n)},R=N.trim=function(t,e){return t=String(P(t)),1&e&&(t=t.replace(L,"")),2&e&&(t=t.replace(A,"")),t},q=N,M=h.parseInt,$=q.trim,j=/^[-+]?0[xX]/,U=8!==M(I+"08")||22!==M(I+"0x16")?function(t,e){var r=$(String(t),3);return M(r,e>>>0||(j.test(r)?16:10))}:M;O(O.G+O.F*(parseInt!=U),{parseInt:U});var C=o.parseInt,K=h.parseFloat,V=q.trim,F=1/K(I+"-0")!=-1/0?function(t){var e=V(String(t),3),r=K(e);return 0===r&&"-"==e.charAt(0)?-0:r}:K;O(O.G+O.F*(parseFloat!=F),{parseFloat:F});var z,G=o.parseFloat,Y=Math.ceil,H=Math.floor,W=function(t){return isNaN(t=+t)?0:(t>0?H:Y)(t)},Z=B,J={}.toString,X=function(t){return J.call(t).slice(8,-1)},Q=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==X(t)?t.split(""):Object(t)},tt=function(t){return Q(P(t))},et=Math.min,rt=Math.max,nt=Math.min,it=i(function(t){var e=h["__core-js_shared__"]||(h["__core-js_shared__"]={});(t.exports=function(t,r){return e[t]||(e[t]=void 0!==r?r:{})})("versions",[]).push({version:o.version,mode:"pure",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})}),ot=0,st=Math.random(),ft=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++ot+st).toString(36))},ht=it("keys"),ut=function(t){return ht[t]||(ht[t]=ft(t))},at=(z=!1,function(t,e,r){var n,i,o=tt(t),s=(n=o.length)>0?et(W(n),9007199254740991):0,f=function(t,e){return(t=W(t))<0?rt(t+e,0):nt(t,e)}(r,s);if(z&&e!=e){for(;s>f;)if((i=o[f++])!=i)return!0}else for(;s>f;f++)if((z||f in o)&&o[f]===e)return z||f||0;return!z&&-1}),pt=ut("IE_PROTO"),ct=function(t,e){var r,n=tt(t),i=0,o=[];for(r in n)r!=pt&&T(n,r)&&o.push(r);for(;e.length>i;)T(n,r=e[i++])&&(~at(o,r)||o.push(r));return o},lt="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),yt=Object.keys||function(t){return ct(t,lt)},mt=l?Object.defineProperties:function(t,e){p(t);for(var r,n=yt(e),i=n.length,o=0;i>o;)S.f(t,r=n[o++],e[r]);return t},gt=h.document,dt=gt&&gt.documentElement,vt=ut("IE_PROTO"),bt=function(){},St=function(){var t,e=g("iframe"),r=lt.length;for(e.style.display="none",dt.appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),St=t.F;r--;)delete St.prototype[lt[r]];return St()},wt=Object.create||function(t,e){var r;return null!==t?(bt.prototype=p(t),r=new bt,bt.prototype=null,r[vt]=t):r=St(),void 0===e?r:mt(r,e)},Bt=i(function(t){var e=it("wks"),r=h.Symbol,n="function"==typeof r;(t.exports=function(t){return e[t]||(e[t]=n&&r[t]||(n?r:ft)("Symbol."+t))}).store=e}),Et=S.f,Tt=Bt("toStringTag"),_t=function(t,e,r){t&&!T(t=r?t:t.prototype,Tt)&&Et(t,Tt,{configurable:!0,value:e})},Ot={};B(Ot,Bt("iterator"),function(){return this});var kt,xt=function(t,e,r){t.prototype=wt(Ot,{next:w(1,r)}),_t(t,e+" Iterator")},Pt=function(t){return Object(P(t))},It=ut("IE_PROTO"),Dt=Object.prototype,Lt=Object.getPrototypeOf||function(t){return t=Pt(t),T(t,It)?t[It]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?Dt:null},At=Bt("iterator"),Nt=!([].keys&&"next"in[].keys()),Rt=function(t,e,r,n,i,o,s){xt(r,e,n);var f,h,u,a=function(t){if(!Nt&&t in y)return y[t];switch(t){case"keys":case"values":return function(){return new r(this,t)}}return function(){return new r(this,t)}},p=e+" Iterator",c="values"==i,l=!1,y=t.prototype,m=y[At]||y["@@iterator"]||i&&y[i],g=m||a(i),d=i?c?a("entries"):g:void 0,v="Array"==e&&y.entries||m;if(v&&(u=Lt(v.call(new t)))!==Object.prototype&&u.next&&_t(u,p,!0),c&&m&&"values"!==m.name&&(l=!0,g=function(){return m.call(this)}),s&&(Nt||l||!y[At])&&B(y,At,g),i)if(f={values:c?g:a("values"),keys:o?g:a("keys"),entries:d},s)for(h in f)h in y||Z(y,h,f[h]);else O(O.P+O.F*(Nt||l),e,f);return f},qt=(kt=!0,function(t,e){var r,n,i=String(P(t)),o=W(e),s=i.length;return o<0||o>=s?kt?"":void 0:(r=i.charCodeAt(o))<55296||r>56319||o+1===s||(n=i.charCodeAt(o+1))<56320||n>57343?kt?i.charAt(o):r:kt?i.slice(o,o+2):n-56320+(r-55296<<10)+65536});Rt(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,r=this._i;return r>=e.length?{value:void 0,done:!0}:(t=qt(e,r),this._i+=t.length,{value:t,done:!1})});for(var Mt=function(t,e){return{value:e,done:!!t}},$t=(Rt(Array,"Array",function(t,e){this._t=tt(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,r=this._i++;return!t||r>=t.length?(this._t=void 0,Mt(1)):Mt(0,"keys"==e?r:"values"==e?t[r]:[r,t[r]])},"values"),Bt("toStringTag")),jt="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),Ut=0;Ut<jt.length;Ut++){var Ct=jt[Ut],Kt=h[Ct],Vt=Kt&&Kt.prototype;Vt&&!Vt[$t]&&B(Vt,$t,Ct)}var Ft={f:Bt},zt=Ft.f("iterator"),Gt=i(function(t){var e=ft("meta"),r=S.f,n=0,i=Object.isExtensible||function(){return!0},o=!c(function(){return i(Object.preventExtensions({}))}),s=function(t){r(t,e,{value:{i:"O"+ ++n,w:{}}})},f=t.exports={KEY:e,NEED:!1,fastKey:function(t,r){if(!a(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!T(t,e)){if(!i(t))return"F";if(!r)return"E";s(t)}return t[e].i},getWeak:function(t,r){if(!T(t,e)){if(!i(t))return!0;if(!r)return!1;s(t)}return t[e].w},onFreeze:function(t){return o&&f.NEED&&i(t)&&!T(t,e)&&s(t),t}}}),Yt=(Gt.KEY,Gt.NEED,Gt.fastKey,Gt.getWeak,Gt.onFreeze,S.f),Ht=function(t){var e=o.Symbol||(o.Symbol={});"_"==t.charAt(0)||t in e||Yt(e,t,{value:Ft.f(t)})},Wt={f:Object.getOwnPropertySymbols},Zt={f:{}.propertyIsEnumerable},Jt=Array.isArray||function(t){return"Array"==X(t)},Xt=lt.concat("length","prototype"),Qt={f:Object.getOwnPropertyNames||function(t){return ct(t,Xt)}},te=Qt.f,ee={}.toString,re="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],ne={f:function(t){return re&&"[object Window]"==ee.call(t)?function(t){try{return te(t)}catch(t){return re.slice()}}(t):te(tt(t))}},ie=Object.getOwnPropertyDescriptor,oe={f:l?ie:function(t,e){if(t=tt(t),e=v(e,!0),d)try{return ie(t,e)}catch(t){}if(T(t,e))return w(!Zt.f.call(t,e),t[e])}},se=Gt.KEY,fe=oe.f,he=S.f,ue=ne.f,ae=h.Symbol,pe=h.JSON,ce=pe&&pe.stringify,le=Bt("_hidden"),ye=Bt("toPrimitive"),me={}.propertyIsEnumerable,ge=it("symbol-registry"),de=it("symbols"),ve=it("op-symbols"),be=Object.prototype,Se="function"==typeof ae&&!!Wt.f,we=h.QObject,Be=!we||!we.prototype||!we.prototype.findChild,Ee=l&&c(function(){return 7!=wt(he({},"a",{get:function(){return he(this,"a",{value:7}).a}})).a})?function(t,e,r){var n=fe(be,e);n&&delete be[e],he(t,e,r),n&&t!==be&&he(be,e,n)}:he,Te=function(t){var e=de[t]=wt(ae.prototype);return e._k=t,e},_e=Se&&"symbol"==typeof ae.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof ae},Oe=function(t,e,r){return t===be&&Oe(ve,e,r),p(t),e=v(e,!0),p(r),T(de,e)?(r.enumerable?(T(t,le)&&t[le][e]&&(t[le][e]=!1),r=wt(r,{enumerable:w(0,!1)})):(T(t,le)||he(t,le,w(1,{})),t[le][e]=!0),Ee(t,e,r)):he(t,e,r)},ke=function(t,e){p(t);for(var r,n=function(t){var e=yt(t),r=Wt.f;if(r)for(var n,i=r(t),o=Zt.f,s=0;i.length>s;)o.call(t,n=i[s++])&&e.push(n);return e}(e=tt(e)),i=0,o=n.length;o>i;)Oe(t,r=n[i++],e[r]);return t},xe=function(t){var e=me.call(this,t=v(t,!0));return!(this===be&&T(de,t)&&!T(ve,t))&&(!(e||!T(this,t)||!T(de,t)||T(this,le)&&this[le][t])||e)},Pe=function(t,e){if(t=tt(t),e=v(e,!0),t!==be||!T(de,e)||T(ve,e)){var r=fe(t,e);return!r||!T(de,e)||T(t,le)&&t[le][e]||(r.enumerable=!0),r}},Ie=function(t){for(var e,r=ue(tt(t)),n=[],i=0;r.length>i;)T(de,e=r[i++])||e==le||e==se||n.push(e);return n},De=function(t){for(var e,r=t===be,n=ue(r?ve:tt(t)),i=[],o=0;n.length>o;)!T(de,e=n[o++])||r&&!T(be,e)||i.push(de[e]);return i};Se||(Z((ae=function(){if(this instanceof ae)throw TypeError("Symbol is not a constructor!");var t=ft(arguments.length>0?arguments[0]:void 0),e=function(r){this===be&&e.call(ve,r),T(this,le)&&T(this[le],t)&&(this[le][t]=!1),Ee(this,t,w(1,r))};return l&&Be&&Ee(be,t,{configurable:!0,set:e}),Te(t)}).prototype,"toString",function(){return this._k}),oe.f=Pe,S.f=Oe,Qt.f=ne.f=Ie,Zt.f=xe,Wt.f=De,Ft.f=function(t){return Te(Bt(t))}),O(O.G+O.W+O.F*!Se,{Symbol:ae});for(var Le="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),Ae=0;Le.length>Ae;)Bt(Le[Ae++]);for(var Ne=yt(Bt.store),Re=0;Ne.length>Re;)Ht(Ne[Re++]);O(O.S+O.F*!Se,"Symbol",{for:function(t){return T(ge,t+="")?ge[t]:ge[t]=ae(t)},keyFor:function(t){if(!_e(t))throw TypeError(t+" is not a symbol!");for(var e in ge)if(ge[e]===t)return e},useSetter:function(){Be=!0},useSimple:function(){Be=!1}}),O(O.S+O.F*!Se,"Object",{create:function(t,e){return void 0===e?wt(t):ke(wt(t),e)},defineProperty:Oe,defineProperties:ke,getOwnPropertyDescriptor:Pe,getOwnPropertyNames:Ie,getOwnPropertySymbols:De});var qe=c(function(){Wt.f(1)});O(O.S+O.F*qe,"Object",{getOwnPropertySymbols:function(t){return Wt.f(Pt(t))}}),pe&&O(O.S+O.F*(!Se||c(function(){var t=ae();return"[null]"!=ce([t])||"{}"!=ce({a:t})||"{}"!=ce(Object(t))})),"JSON",{stringify:function(t){for(var e,r,n=[t],i=1;arguments.length>i;)n.push(arguments[i++]);if(r=e=n[1],(a(e)||void 0!==t)&&!_e(t))return Jt(e)||(e=function(t,e){if("function"==typeof r&&(e=r.call(this,t,e)),!_e(e))return e}),n[1]=e,ce.apply(pe,n)}}),ae.prototype[ye]||B(ae.prototype,ye,ae.prototype.valueOf),_t(ae,"Symbol"),_t(Math,"Math",!0),_t(h.JSON,"JSON",!0),Ht("asyncIterator"),Ht("observable");var Me=o.Symbol,$e=i(function(t){function e(t){return(e="function"==typeof Me&&"symbol"==typeof zt?function(t){return typeof t}:function(t){return t&&"function"==typeof Me&&t.constructor===Me&&t!==Me.prototype?"symbol":typeof t})(t)}function r(n){return"function"==typeof Me&&"symbol"===e(zt)?t.exports=r=function(t){return e(t)}:t.exports=r=function(t){return t&&"function"==typeof Me&&t.constructor===Me&&t!==Me.prototype?"symbol":e(t)},r(n)}t.exports=r}),je={linebrk:function(t,e){for(var r="",n=0;n+e<t.length;)r+=t.substring(n,n+e)+"\n",n+=e;return r+t.substring(n,t.length)},detectEnvironment:function(){return"browser"},get32IntFromBuffer:function(t,e){e=e||0;var r;if(0<(r=t.length-e)){if(4<=r)return t.readUInt32BE(e);for(var n=0,i=e+r,o=0;i>e;i--,o+=2)n+=t[i-1]*Math.pow(16,o);return n}return NaN},_:{isObject:function(t){var e=$e(t);return!!t&&("object"==e||"function"==e)},isString:function(t){return"string"==typeof t||t instanceof String},isNumber:function(t){return"number"==typeof t||!isNaN(G(t))&&isFinite(t)},omit:function(t,e){var r={};for(var n in t)t.hasOwnProperty(n)&&n!==e&&(r[n]=t[n]);return r}},trimSurroundingText:function(t,e,r){var n=0,i=t.length,o=t.indexOf(e);0<=o&&(n=o+e.length);var s=t.indexOf(r,o);return 0<=s&&(i=s),t.substring(n,i)}},Ue={},Ce=je._;function Ke(t,e){null!=t&&("number"==typeof t?this.fromNumber(t,e):Buffer.isBuffer(t)?this.fromBuffer(t):null==e&&"string"!=typeof t?this.fromByteArray(t):this.fromString(t,e))}function Ve(){return new Ke(null)}Ke.prototype.am=function(t,e,r,n,i,o){for(var s=16383&e,f=e>>14;0<=--o;){var h=16383&this[t],u=this[t++]>>14,a=f*h+u*s;i=((h=s*h+((16383&a)<<14)+r[n]+i)>>28)+(a>>14)+f*u,r[n++]=268435455&h}return i},Ke.prototype.DB=28,Ke.prototype.DM=268435455,Ke.prototype.DV=1<<28;Ke.prototype.FV=Math.pow(2,52),Ke.prototype.F1=24,Ke.prototype.F2=4;var Fe,ze,Ge="0123456789abcdefghijklmnopqrstuvwxyz",Ye=[];for(Fe="0".charCodeAt(0),ze=0;9>=ze;++ze)Ye[Fe++]=ze;for(Fe="a".charCodeAt(0),ze=10;36>ze;++ze)Ye[Fe++]=ze;for(Fe="A".charCodeAt(0),ze=10;36>ze;++ze)Ye[Fe++]=ze;function He(t){return Ge.charAt(t)}function We(t,e){var r=Ye[t.charCodeAt(e)];return null==r?-1:r}function Ze(t){var e=Ve();return e.fromInt(t),e}function Je(t){var e,r=1;return 0!=(e=t>>>16)&&(t=e,r+=16),0!=(e=t>>8)&&(t=e,r+=8),0!=(e=t>>4)&&(t=e,r+=4),0!=(e=t>>2)&&(t=e,r+=2),0!=(e=t>>1)&&(t=e,r+=1),r}function Xe(t){this.m=t}function Qe(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function tr(t,e){return t&e}function er(t,e){return t|e}function rr(t,e){return t^e}function nr(t,e){return t&~e}function ir(t){if(0===t)return-1;var e=0;return 0==(65535&t)&&(t>>=16,e+=16),0==(255&t)&&(t>>=8,e+=8),0==(15&t)&&(t>>=4,e+=4),0==(3&t)&&(t>>=2,e+=2),0==(1&t)&&++e,e}function or(t){for(var e=0;0!=t;)t&=t-1,++e;return e}function sr(){}function fr(t){return t}function hr(t){this.r2=Ve(),this.q3=Ve(),Ke.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}Xe.prototype.convert=function(t){return 0>t.s||0<=t.compareTo(this.m)?t.mod(this.m):t},Xe.prototype.revert=function(t){return t},Xe.prototype.reduce=function(t){t.divRemTo(this.m,null,t)},Xe.prototype.mulTo=function(t,e,r){t.multiplyTo(e,r),this.reduce(r)},Xe.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},Qe.prototype.convert=function(t){var e=Ve();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),0>t.s&&0<e.compareTo(Ke.ZERO)&&this.m.subTo(e,e),e},Qe.prototype.revert=function(t){var e=Ve();return t.copyTo(e),this.reduce(e),e},Qe.prototype.reduce=function(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=32767&t[e],n=r*this.mpl+((r*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(t[r=e+this.m.t]+=this.m.am(0,n,t,e,0,this.m.t);t[r]>=t.DV;)t[r]-=t.DV,t[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),0<=t.compareTo(this.m)&&t.subTo(this.m,t)},Qe.prototype.mulTo=function(t,e,r){t.multiplyTo(e,r),this.reduce(r)},Qe.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},sr.prototype.convert=fr,sr.prototype.revert=fr,sr.prototype.mulTo=function(t,e,r){t.multiplyTo(e,r)},sr.prototype.sqrTo=function(t,e){t.squareTo(e)},hr.prototype.convert=function(t){if(0>t.s||t.t>2*this.m.t)return t.mod(this.m);if(0>t.compareTo(this.m))return t;var e=Ve();return t.copyTo(e),this.reduce(e),e},hr.prototype.revert=function(t){return t},hr.prototype.reduce=function(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);0>t.compareTo(this.r2);)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);0<=t.compareTo(this.m);)t.subTo(this.m,t)},hr.prototype.mulTo=function(t,e,r){t.multiplyTo(e,r),this.reduce(r)},hr.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)};var ur=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],ar=(1<<26)/ur[ur.length-1];Ke.prototype.copyTo=function(t){for(var e=this.t-1;0<=e;--e)t[e]=this[e];t.t=this.t,t.s=this.s},Ke.prototype.fromInt=function(t){this.t=1,this.s=0>t?-1:0,0<t?this[0]=t:-1>t?this[0]=t+DV:this.t=0},Ke.prototype.fromString=function(t,e,r){var n;switch(e){case 2:n=1;break;case 4:n=2;break;case 8:n=3;break;case 16:n=4;break;case 32:n=5;break;case 256:n=8;break;default:return void this.fromRadix(t,e)}this.t=0,this.s=0;for(var i=t.length,o=!1,s=0;0<=--i;){var f=8==n?255&t[i]:We(t,i);0>f?"-"==t.charAt(i)&&(o=!0):(o=!1,0===s?this[this.t++]=f:s+n>this.DB?(this[this.t-1]|=(f&(1<<this.DB-s)-1)<<s,this[this.t++]=f>>this.DB-s):this[this.t-1]|=f<<s,(s+=n)>=this.DB&&(s-=this.DB))}r||8!=n||0==(128&t[0])||(this.s=-1,0<s&&(this[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),o&&Ke.ZERO.subTo(this,this)},Ke.prototype.fromByteArray=function(t,e){this.fromString(t,256,e)},Ke.prototype.fromBuffer=function(t){this.fromString(t,256,!0)},Ke.prototype.clamp=function(){for(var t=this.s&this.DM;0<this.t&&this[this.t-1]==t;)--this.t},Ke.prototype.dlShiftTo=function(t,e){var r;for(r=this.t-1;0<=r;--r)e[r+t]=this[r];for(r=t-1;0<=r;--r)e[r]=0;e.t=this.t+t,e.s=this.s},Ke.prototype.drShiftTo=function(t,e){for(var r=t;r<this.t;++r)e[r-t]=this[r];e.t=Math.max(this.t-t,0),e.s=this.s},Ke.prototype.lShiftTo=function(t,e){var r,n=t%this.DB,i=this.DB-n,o=Math.floor(t/this.DB),s=this.s<<n&this.DM;for(r=this.t-1;0<=r;--r)e[r+o+1]=this[r]>>i|s,s=(this[r]&(1<<i)-1)<<n;for(r=o-1;0<=r;--r)e[r]=0;e[o]=s,e.t=this.t+o+1,e.s=this.s,e.clamp()},Ke.prototype.rShiftTo=function(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t)e.t=0;else{var n=t%this.DB,i=this.DB-n,o=(1<<n)-1;e[0]=this[r]>>n;for(var s=r+1;s<this.t;++s)e[s-r-1]|=(this[s]&o)<<i,e[s-r]=this[s]>>n;0<n&&(e[this.t-r-1]|=(this.s&o)<<i),e.t=this.t-r,e.clamp()}},Ke.prototype.subTo=function(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this[r]-t[r],e[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this[r],e[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t[r],e[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=0>n?-1:0,-1>n?e[r++]=this.DV+n:0<n&&(e[r++]=n),e.t=r,e.clamp()},Ke.prototype.multiplyTo=function(t,e){var r=this.abs(),n=t.abs(),i=r.t;for(e.t=i+n.t;0<=--i;)e[i]=0;for(i=0;i<n.t;++i)e[i+r.t]=r.am(0,n[i],e,i,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&Ke.ZERO.subTo(e,e)},Ke.prototype.squareTo=function(t){for(var e=this.abs(),r=t.t=2*e.t;0<=--r;)t[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e[r],t,2*r,0,1);(t[r+e.t]+=e.am(r+1,2*e[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t[r+e.t]-=e.DV,t[r+e.t+1]=1)}0<t.t&&(t[t.t-1]+=e.am(r,e[r],t,2*r,0,1)),t.s=0,t.clamp()},Ke.prototype.divRemTo=function(t,e,r){var n=t.abs();if(!(0>=n.t)){var i=this.abs();if(i.t<n.t)return null!=e&&e.fromInt(0),void(null!=r&&this.copyTo(r));null==r&&(r=Ve());var o=Ve(),s=this.s,f=t.s,h=this.DB-Je(n[n.t-1]);0<h?(n.lShiftTo(h,o),i.lShiftTo(h,r)):(n.copyTo(o),i.copyTo(r));var u=o.t,a=o[u-1];if(0!==a){var p=a*(1<<this.F1)+(1<u?o[u-2]>>this.F2:0),c=this.FV/p,l=(1<<this.F1)/p,y=1<<this.F2,m=r.t,g=m-u,d=null==e?Ve():e;for(o.dlShiftTo(g,d),0<=r.compareTo(d)&&(r[r.t++]=1,r.subTo(d,r)),Ke.ONE.dlShiftTo(u,d),d.subTo(o,o);o.t<u;)o[o.t++]=0;for(;0<=--g;){var v=r[--m]==a?this.DM:Math.floor(r[m]*c+(r[m-1]+y)*l);if((r[m]+=o.am(0,v,r,g,0,u))<v)for(o.dlShiftTo(g,d),r.subTo(d,r);r[m]<--v;)r.subTo(d,r)}null!=e&&(r.drShiftTo(u,e),s!=f&&Ke.ZERO.subTo(e,e)),r.t=u,r.clamp(),0<h&&r.rShiftTo(h,r),0>s&&Ke.ZERO.subTo(r,r)}}},Ke.prototype.invDigit=function(){if(1>this.t)return 0;var t=this[0];if(0==(1&t))return 0;var e=3&t;return 0<(e=(e=65535&(e=255&(e=15&e*(2-(15&t)*e))*(2-(255&t)*e))*(2-(65535&(65535&t)*e)))*(2-t*e%this.DV)%this.DV)?this.DV-e:-e},Ke.prototype.isEven=function(){return 0===(0<this.t?1&this[0]:this.s)},Ke.prototype.exp=function(t,e){if(4294967295<t||1>t)return Ke.ONE;var r=Ve(),n=Ve(),i=e.convert(this),o=Je(t)-1;for(i.copyTo(r);0<=--o;)if(e.sqrTo(r,n),0<(t&1<<o))e.mulTo(n,i,r);else{var s=r;r=n,n=s}return e.revert(r)},Ke.prototype.chunkSize=function(t){return Math.floor(Math.LN2*this.DB/Math.log(t))},Ke.prototype.toRadix=function(t){if(null==t&&(t=10),0===this.signum()||2>t||36<t)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),n=Ze(r),i=Ve(),o=Ve(),s="";for(this.divRemTo(n,i,o);0<i.signum();)s=(r+o.intValue()).toString(t).substr(1)+s,i.divRemTo(n,i,o);return o.intValue().toString(t)+s},Ke.prototype.fromRadix=function(t,e){this.fromInt(0),null==e&&(e=10);for(var r,n=this.chunkSize(e),i=Math.pow(e,n),o=!1,s=0,f=0,h=0;h<t.length;++h)0>(r=We(t,h))?"-"==t.charAt(h)&&0===this.signum()&&(o=!0):(f=e*f+r,++s>=n&&(this.dMultiply(i),this.dAddOffset(f,0),s=0,f=0));0<s&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(f,0)),o&&Ke.ZERO.subTo(this,this)},Ke.prototype.fromNumber=function(t,e){if("number"!=typeof e){var r=Ue.randomBytes(1+(t>>3)),n=7&t;0<n?r[0]&=(1<<n)-1:r[0]=0,this.fromByteArray(r)}else if(2>t)this.fromInt(1);else for(this.fromNumber(t),this.testBit(t-1)||this.bitwiseTo(Ke.ONE.shiftLeft(t-1),er,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(Ke.ONE.shiftLeft(t-1),this)},Ke.prototype.bitwiseTo=function(t,e,r){var n,i,o=Math.min(t.t,this.t);for(n=0;n<o;++n)r[n]=e(this[n],t[n]);if(t.t<this.t){for(i=t.s&this.DM,n=o;n<this.t;++n)r[n]=e(this[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=o;n<t.t;++n)r[n]=e(i,t[n]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()},Ke.prototype.changeBit=function(t,e){var r=Ke.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r},Ke.prototype.addTo=function(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this[r]+t[r],e[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;r<this.t;)n+=this[r],e[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n+=t[r],e[r++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=0>n?-1:0,0<n?e[r++]=n:-1>n&&(e[r++]=this.DV+n),e.t=r,e.clamp()},Ke.prototype.dMultiply=function(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()},Ke.prototype.dAddOffset=function(t,e){if(0!==t){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}},Ke.prototype.multiplyLowerTo=function(t,e,r){var n,i=Math.min(this.t+t.t,e);for(r.s=0,r.t=i;0<i;)r[--i]=0;for(n=r.t-this.t;i<n;++i)r[i+this.t]=this.am(0,t[i],r,i,0,this.t);for(n=Math.min(t.t,e);i<n;++i)this.am(0,t[i],r,i,0,e-i);r.clamp()},Ke.prototype.multiplyUpperTo=function(t,e,r){--e;var n=r.t=this.t+t.t-e;for(r.s=0;0<=--n;)r[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)r[this.t+n-e]=this.am(e-n,t[n],r,0,0,this.t+n-e);r.clamp(),r.drShiftTo(1,r)},Ke.prototype.modInt=function(t){if(0>=t)return 0;var e=this.DV%t,r=0>this.s?t-1:0;if(0<this.t)if(0==e)r=this[0]%t;else for(var n=this.t-1;0<=n;--n)r=(e*r+this[n])%t;return r},Ke.prototype.millerRabin=function(t){var e=this.subtract(Ke.ONE),r=e.getLowestSetBit();if(0>=r)return!1;var n=e.shiftRight(r);(t=t+1>>1)>ur.length&&(t=ur.length);for(var i=Ve(),o=0;o<t;++o){i.fromInt(ur[Math.floor(Math.random()*ur.length)]);var s=i.modPow(n,this);if(0!=s.compareTo(Ke.ONE)&&0!=s.compareTo(e)){for(var f=1;f++<r&&0!=s.compareTo(e);)if(0===(s=s.modPowInt(2,this)).compareTo(Ke.ONE))return!1;if(0!=s.compareTo(e))return!1}}return!0},Ke.prototype.toString=function(t){if(0>this.s)return"-"+this.negate().toString(t);var e;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return this.toRadix(t);e=2}var r,n=(1<<e)-1,i=!1,o="",s=this.t,f=this.DB-s*this.DB%e;if(0<s--)for(f<this.DB&&0<(r=this[s]>>f)&&(i=!0,o=He(r));0<=s;)f<e?(r=(this[s]&(1<<f)-1)<<e-f,r|=this[--s]>>(f+=this.DB-e)):(r=this[s]>>(f-=e)&n,0>=f&&(f+=this.DB,--s)),0<r&&(i=!0),i&&(o+=He(r));return i?o:"0"},Ke.prototype.negate=function(){var t=Ve();return Ke.ZERO.subTo(this,t),t},Ke.prototype.abs=function(){return 0>this.s?this.negate():this},Ke.prototype.compareTo=function(t){var e=this.s-t.s;if(0!=e)return e;var r=this.t;if(0!=(e=r-t.t))return 0>this.s?-e:e;for(;0<=--r;)if(0!=(e=this[r]-t[r]))return e;return 0},Ke.prototype.bitLength=function(){return 0>=this.t?0:this.DB*(this.t-1)+Je(this[this.t-1]^this.s&this.DM)},Ke.prototype.mod=function(t){var e=Ve();return this.abs().divRemTo(t,null,e),0>this.s&&0<e.compareTo(Ke.ZERO)&&t.subTo(e,e),e},Ke.prototype.modPowInt=function(t,e){var r;return r=256>t||e.isEven()?new Xe(e):new Qe(e),this.exp(t,r)},Ke.prototype.clone=function(){var t=Ve();return this.copyTo(t),t},Ke.prototype.intValue=function(){if(0>this.s){if(1==this.t)return this[0]-this.DV;if(0===this.t)return-1}else{if(1==this.t)return this[0];if(0===this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},Ke.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},Ke.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},Ke.prototype.signum=function(){return 0>this.s?-1:0>=this.t||1==this.t&&0>=this[0]?0:1},Ke.prototype.toByteArray=function(){var t=this.t,e=[];e[0]=this.s;var r,n=this.DB-t*this.DB%8,i=0;if(0<t--)for(n<this.DB&&(r=this[t]>>n)!=(this.s&this.DM)>>n&&(e[i++]=r|this.s<<this.DB-n);0<=t;)8>n?(r=(this[t]&(1<<n)-1)<<8-n,r|=this[--t]>>(n+=this.DB-8)):(r=255&this[t]>>(n-=8),0>=n&&(n+=this.DB,--t)),0!=(128&r)&&(r|=-256),0==i&&(128&this.s)!=(128&r)&&++i,(0<i||r!=this.s)&&(e[i++]=r);return e},Ke.prototype.toBuffer=function(t){var e=Buffer.from(this.toByteArray());if(!0===t&&0===e[0])e=e.slice(1);else if(Ce.isNumber(t)){if(e.length>t){for(var r=0;r<e.length-t;r++)if(0!==e[r])return null;return e.slice(e.length-t)}if(e.length<t){var n=Buffer.alloc(t);return n.fill(0,0,t-e.length),e.copy(n,t-e.length),n}}return e},Ke.prototype.equals=function(t){return 0==this.compareTo(t)},Ke.prototype.min=function(t){return 0>this.compareTo(t)?this:t},Ke.prototype.max=function(t){return 0<this.compareTo(t)?this:t},Ke.prototype.and=function(t){var e=Ve();return this.bitwiseTo(t,tr,e),e},Ke.prototype.or=function(t){var e=Ve();return this.bitwiseTo(t,er,e),e},Ke.prototype.xor=function(t){var e=Ve();return this.bitwiseTo(t,rr,e),e},Ke.prototype.andNot=function(t){var e=Ve();return this.bitwiseTo(t,nr,e),e},Ke.prototype.not=function(){for(var t=Ve(),e=0;e<this.t;++e)t[e]=this.DM&~this[e];return t.t=this.t,t.s=~this.s,t},Ke.prototype.shiftLeft=function(t){var e=Ve();return 0>t?this.rShiftTo(-t,e):this.lShiftTo(t,e),e},Ke.prototype.shiftRight=function(t){var e=Ve();return 0>t?this.lShiftTo(-t,e):this.rShiftTo(t,e),e},Ke.prototype.getLowestSetBit=function(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+ir(this[t]);return 0>this.s?this.t*this.DB:-1},Ke.prototype.bitCount=function(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=or(this[r]^e);return t},Ke.prototype.testBit=function(t){var e=Math.floor(t/this.DB);return e>=this.t?0!=this.s:0!=(this[e]&1<<t%this.DB)},Ke.prototype.setBit=function(t){return this.changeBit(t,er)},Ke.prototype.clearBit=function(t){return this.changeBit(t,nr)},Ke.prototype.flipBit=function(t){return this.changeBit(t,rr)},Ke.prototype.add=function(t){var e=Ve();return this.addTo(t,e),e},Ke.prototype.subtract=function(t){var e=Ve();return this.subTo(t,e),e},Ke.prototype.multiply=function(t){var e=Ve();return this.multiplyTo(t,e),e},Ke.prototype.divide=function(t){var e=Ve();return this.divRemTo(t,e,null),e},Ke.prototype.remainder=function(t){var e=Ve();return this.divRemTo(t,null,e),e},Ke.prototype.divideAndRemainder=function(t){var e=Ve(),r=Ve();return this.divRemTo(t,e,r),[e,r]},Ke.prototype.modPow=function(t,e){var r,n,i=t.bitLength(),o=Ze(1);if(0>=i)return o;r=18>i?1:48>i?3:144>i?4:768>i?5:6,n=8>i?new Xe(e):e.isEven()?new hr(e):new Qe(e);var s=[],f=3,h=r-1,u=(1<<r)-1;if(s[1]=n.convert(this),1<r){var a=Ve();for(n.sqrTo(s[1],a);f<=u;)s[f]=Ve(),n.mulTo(a,s[f-2],s[f]),f+=2}var p,c,l=t.t-1,y=!0,m=Ve();for(i=Je(t[l])-1;0<=l;){for(i>=h?p=t[l]>>i-h&u:(p=(t[l]&(1<<i+1)-1)<<h-i,0<l&&(p|=t[l-1]>>this.DB+i-h)),f=r;0==(1&p);)p>>=1,--f;if(0>(i-=f)&&(i+=this.DB,--l),y)s[p].copyTo(o),y=!1;else{for(;1<f;)n.sqrTo(o,m),n.sqrTo(m,o),f-=2;0<f?n.sqrTo(o,m):(c=o,o=m,m=c),n.mulTo(m,s[p],o)}for(;0<=l&&0==(t[l]&1<<i);)n.sqrTo(o,m),c=o,o=m,m=c,0>--i&&(i=this.DB-1,--l)}return n.revert(o)},Ke.prototype.modInverse=function(t){var e=t.isEven();if(this.isEven()&&e||0===t.signum())return Ke.ZERO;for(var r=t.clone(),n=this.clone(),i=Ze(1),o=Ze(0),s=Ze(0),f=Ze(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),e?((!i.isEven()||!o.isEven())&&(i.addTo(this,i),o.subTo(t,o)),i.rShiftTo(1,i)):!o.isEven()&&o.subTo(t,o),o.rShiftTo(1,o);for(;n.isEven();)n.rShiftTo(1,n),e?((!s.isEven()||!f.isEven())&&(s.addTo(this,s),f.subTo(t,f)),s.rShiftTo(1,s)):!f.isEven()&&f.subTo(t,f),f.rShiftTo(1,f);0<=r.compareTo(n)?(r.subTo(n,r),e&&i.subTo(s,i),o.subTo(f,o)):(n.subTo(r,n),e&&s.subTo(i,s),f.subTo(o,f))}return 0!=n.compareTo(Ke.ONE)?Ke.ZERO:0<=f.compareTo(t)?f.subtract(t):0>f.signum()?(f.addTo(t,f),0>f.signum()?f.add(t):f):f},Ke.prototype.pow=function(t){return this.exp(t,new sr)},Ke.prototype.gcd=function(t){var e=0>this.s?this.negate():this.clone(),r=0>t.s?t.negate():t.clone();if(0>e.compareTo(r)){var n=e;e=r,r=n}var i=e.getLowestSetBit(),o=r.getLowestSetBit();if(0>o)return e;for(i<o&&(o=i),0<o&&(e.rShiftTo(o,e),r.rShiftTo(o,r));0<e.signum();)0<(i=e.getLowestSetBit())&&e.rShiftTo(i,e),0<(i=r.getLowestSetBit())&&r.rShiftTo(i,r),0<=e.compareTo(r)?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return 0<o&&r.lShiftTo(o,r),r},Ke.prototype.isProbablePrime=function(t){var e,r=this.abs();if(1==r.t&&r[0]<=ur[ur.length-1]){for(e=0;e<ur.length;++e)if(r[0]==ur[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<ur.length;){for(var n=ur[e],i=e+1;i<ur.length&&n<ar;)n*=ur[i++];for(n=r.modInt(n);e<i;)if(0==n%ur[e++])return!1}return r.millerRabin(t)},Ke.int2char=He,Ke.ZERO=Ze(0),Ke.ONE=Ze(1),Ke.prototype.square=function(){var t=Ve();return this.squareTo(t),t};var pr=Ke,cr=function(t){if(t>4294967295)throw new RangeError("requested too many random bytes");var e=Buffer.allocUnsafe(t);if(0<t)if(t>65536)for(var r=0;r<t;r+=65536)lr(e.slice(r,r+65536));else lr(e);return e};function lr(t){for(var e=0;e<t.length;e++)t[e]=Math.floor(256*Math.random())}var yr=i(function(t,e){var n=r.Buffer;function i(t,e){for(var r in t)e[r]=t[r]}function o(t,e,r){return n(t,e,r)}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?t.exports=r:(i(r,e),e.Buffer=o),o.prototype=Object.create(n.prototype),i(n,o),o.from=function(t,e,r){if("number"==typeof t)throw new TypeError("Argument must not be a number");return n(t,e,r)},o.alloc=function(t,e,r){if("number"!=typeof t)throw new TypeError("Argument must be a number");var i=n(t);return void 0!==e?"string"==typeof r?i.fill(e,r):i.fill(e):i.fill(0),i},o.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return n(t)},o.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return r.SlowBuffer(t)}}),mr=(yr.Buffer,yr.Buffer),gr=function(t,r){for(var n,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"sha1",o=mr.alloc(0),s=0;o.length<r;)n=dr(s++),o=mr.concat([o,e(i).update(t).update(n).digest()]);return o.slice(0,r)};function dr(t){var e=mr.allocUnsafe(4);return e.writeUInt32BE(t,0),e}var vr=function(t,e){for(var r=t.length,n=-1;++n<r;)t[n]^=e[n];return t};function br(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"sha256",e=0;return"md5-96"===(t=t.toLowerCase())||"sha1-96"===t||"sha256-96"===t||"sha512-96"===t?(t=t.substr(0,-3),e=12):"md2"===t||"md5"===t?e=16:"sha1"===t?e=20:"sha256"===t?e=32:"sha384"===t?e=48:"sha512"===t&&(e=64),e}var Sr=function(){for(var t,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=r.data,i=void 0===n?"":n,o=r.mgf,s=void 0===o?"sha1":o,f=r.pad1,h=void 0===f?"":f,u=r.hash,a=void 0===u?"sha256":u,p=r.encryptedDataLength,c=void 0===p?256:p,l=e(a).update(h,"utf8").digest(),y=br(a),m=Buffer.alloc(c-i.length-2*y-2),g=cr(32),d=0;d<g.length;d++){for(t=g[d];0===t;)t=cr(1)[0];g[d]=t}var v=Buffer.concat([l,m,Buffer.from(String.fromCharCode(1)),i]),b=gr(g,c-y-1,s),S=vr(v,b),w=gr(S,y,s),B=vr(g,w),E=Buffer.concat([Buffer.from(String.fromCharCode(0)),B,S]);return E},wr={md2:Buffer.from("3020300c06082a864886f70d020205000410","hex"),md5:Buffer.from("3020300c06082a864886f70d020505000410","hex"),sha1:Buffer.from("3021300906052b0e03021a05000414","hex"),sha224:Buffer.from("302d300d06096086480165030402040500041c","hex"),sha256:Buffer.from("3031300d060960864801650304020105000420","hex"),sha384:Buffer.from("3041300d060960864801650304020205000430","hex"),sha512:Buffer.from("3051300d060960864801650304020305000440","hex"),ripemd160:Buffer.from("3021300906052b2403020105000414","hex"),rmd160:Buffer.from("3021300906052b2403020105000414","hex")},Br={ripemd160:"rmd160"},Er={isEncryption:!0,isSignature:!0};Er.makeScheme=function(e,r){function n(t,e){this.key=t,this.options=e}return n.prototype.maxMessageLength=function(){return this.options.encryptionSchemeOptions&&this.options.encryptionSchemeOptions.padding==t.RSA_NO_PADDING?this.key.encryptedDataLength:this.key.encryptedDataLength-11},n.prototype.encPad=function(e,r){var n;if(r=r||{},e.length>this.key.maxMessageLength)throw new Error("Message too long for RSA (n="+this.key.encryptedDataLength+", l="+e.length+")");if(this.options.encryptionSchemeOptions&&this.options.encryptionSchemeOptions.padding==t.RSA_NO_PADDING)return(n=Buffer.alloc(this.key.maxMessageLength-e.length)).fill(0),Buffer.concat([n,e]);if(1===r.type)return(n=Buffer.alloc(this.key.encryptedDataLength-e.length-1)).fill(255,0,n.length-1),n[0]=1,n[n.length-1]=0,Buffer.concat([n,e]);if(this.options&&this.options.encryptionSchemeOptions&&this.options.encryptionSchemeOptions.mgf){var i=this.options.encryptionSchemeOptions,o=i.mgf,s=i.hash;return Sr({data:e,mgf:o,hash:s,encryptedDataLength:this.encryptedDataLength})}(n=Buffer.alloc(this.key.encryptedDataLength-e.length))[0]=0,n[1]=2;for(var f,h=Ue.randomBytes(n.length-3),u=0;u<h.length;u++){for(f=h[u];0===f;)f=Ue.randomBytes(1)[0];n[u+2]=f}return n[n.length-1]=0,Buffer.concat([n,e])},n.prototype.yihuo=function(t,e){return t.split("").map(function(t,r){return t===e[r]?0:1}).join("")},n.prototype.hexToBin=function(t){for(var e=[{key:0,val:"0000"},{key:1,val:"0001"},{key:2,val:"0010"},{key:3,val:"0011"},{key:4,val:"0100"},{key:5,val:"0101"},{key:6,val:"0110"},{key:7,val:"0111"},{key:8,val:"1000"},{key:9,val:"1001"},{key:"a",val:"1010"},{key:"b",val:"1011"},{key:"c",val:"1100"},{key:"d",val:"1101"},{key:"e",val:"1110"},{key:"f",val:"1111"}],r="",n=0;n<t.length;n++)for(var i=0;i<e.length;i++)if(t.charAt(n)==e[i].key){r=r.concat(e[i].val);break}return r},n.prototype.binToHex=function(t){var e=[{key:0,val:"0000"},{key:1,val:"0001"},{key:2,val:"0010"},{key:3,val:"0011"},{key:4,val:"0100"},{key:5,val:"0101"},{key:6,val:"0110"},{key:7,val:"0111"},{key:8,val:"1000"},{key:9,val:"1001"},{key:"a",val:"1010"},{key:"b",val:"1011"},{key:"c",val:"1100"},{key:"d",val:"1101"},{key:"e",val:"1110"},{key:"f",val:"1111"}],r="",n=[];for(0!=t.length%4&&(t="0000".substring(0,4-t.length%4).concat(t));4<t.length;)n.push(t.substring(0,4)),t=t.substring(4);n.push(t);for(var i=0;i<n.length;i++)for(var o=0;o<e.length;o++)if(n[i]==e[o].val){r=r.concat(e[o].key);break}return r},n.prototype._mgf1=function(t,e){for(var r,n=[],i=Math.ceil(e/20),o=0;o<i;o++)r=this.unsignedLongBuffer(o),n.push(Ue.createHash("sha1").update(Buffer.concat([t,r]),"hex").digest());return n=Buffer.alloc(e,Buffer.concat(n))},n.prototype.unsignedLongBuffer=function(t){var e=f({type:"Buffer",data:[0,0,0,t]});return JSON.parse(e,function(t,e){return e&&"Buffer"===e.type?Buffer.from(e.data):e})},n.prototype.randomBytes=function(t){if(t>4294967295)throw new RangeError("requested too many random bytes");var e=Buffer.allocUnsafe(t);if(0<t)if(t>65536)for(var r=0;r<t;r+=65536)this.getRandomValues(e.slice(r,r+65536));else this.getRandomValues(e);return e},n.prototype.getRandomValues=function(t){for(var e=0;e<t.length;e++)t[e]=Math.floor(256*Math.random())},n.prototype.encUnPad=function(e,r){r=r||{};var n=0;if(this.options.encryptionSchemeOptions&&this.options.encryptionSchemeOptions.padding==t.RSA_NO_PADDING)return"function"==typeof e.lastIndexOf?e.slice(e.lastIndexOf("\0")+1,e.length):e.slice(String.prototype.lastIndexOf.call(e,"\0")+1,e.length);if(4>e.length)return null;if(1===r.type){if(0!==e[0]&&1!==e[1])return null;for(n=3;0!==e[n];)if(255!=e[n]||++n>=e.length)return null}else{if(0!==e[0]&&2!==e[1])return null;for(n=3;0!==e[n];)if(++n>=e.length)return null}return e.slice(n+1,e.length)},n.prototype.sign=function(t){var e=this.options.signingSchemeOptions.hash||"sha256";if("browser"===this.options.environment){e=Br[e]||e;var r=Ue.createHash(e);r.update(t);var n=this.pkcs1pad(r.digest(),e);return this.key.$doPrivate(new pr(n)).toBuffer(this.key.encryptedDataLength)}var i=Ue.createSign("RSA-"+e.toUpperCase());return i.update(t),i.sign(this.options.rsaUtils.exportKey("private"))},n.prototype.verify=function(e,r,n){if(this.options.encryptionSchemeOptions&&this.options.encryptionSchemeOptions.padding==t.RSA_NO_PADDING)return!1;var i=this.options.signingSchemeOptions.hash||"sha256";if("browser"===this.options.environment){i=Br[i]||i,n&&(r=Buffer.from(r,n));var o=Ue.createHash(i);o.update(e);var s=this.pkcs1pad(o.digest(),i);return this.key.$doPublic(new pr(r)).toBuffer().toString("hex")==s.toString("hex")}var f=Ue.createVerify("RSA-"+i.toUpperCase());return f.update(e),f.verify(this.options.rsaUtils.exportKey("public"),r,n)},n.prototype.pkcs0pad=function(t){var e=Buffer.alloc(this.key.maxMessageLength-t.length);return e.fill(0),Buffer.concat([e,t])},n.prototype.pkcs0unpad=function(t){return"function"==typeof t.lastIndexOf?t.slice(t.lastIndexOf("\0")+1,t.length):t.slice(String.prototype.lastIndexOf.call(t,"\0")+1,t.length)},n.prototype.pkcs1pad=function(t,e){var r=wr[e];if(!r)throw Error("Unsupported hash algorithm");var n=Buffer.concat([r,t]);if(n.length+10>this.key.encryptedDataLength)throw Error("Key is too short for signing algorithm ("+e+")");var i=Buffer.alloc(this.key.encryptedDataLength-n.length-1);return i.fill(255,0,i.length-1),i[0]=1,i[i.length-1]=0,Buffer.concat([i,n])},new n(e,r)};var Tr=i(function(t){t.exports={isEncryption:!0,isSignature:!1},t.exports.digestLength={md4:16,md5:16,ripemd160:20,rmd160:20,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64};t.exports.eme_oaep_mgf1=function(e,r,n){n=n||"sha1";for(var i,o=t.exports.digestLength[n],s=Math.ceil(r/o),f=Buffer.alloc(o*s),h=Buffer.alloc(4),u=0;u<s;++u)(i=Ue.createHash(n)).update(e),h.writeUInt32BE(u,0),i.update(h),i.digest().copy(f,u*o);return f.slice(0,r)},t.exports.makeScheme=function(e,r){function n(t,e){this.key=t,this.options=e}return n.prototype.maxMessageLength=function(){return this.key.encryptedDataLength-2*t.exports.digestLength[this.options.encryptionSchemeOptions.hash||"sha1"]-2},n.prototype.encPad=function(e){var r=this.options.encryptionSchemeOptions.hash||"sha1",n=this.options.encryptionSchemeOptions.mgf||t.exports.eme_oaep_mgf1,i=this.options.encryptionSchemeOptions.label||Buffer.alloc(0),o=this.key.encryptedDataLength,s=t.exports.digestLength[r];if(e.length>o-2*s-2)throw new Error("Message is too long to encode into an encoded message with a length of "+o+" bytes, increaseemLen to fix this error (minimum value for given parameters and options: "+(o-2*s-2)+")");var f=Ue.createHash(r);f.update(i),f=f.digest();var h=Buffer.alloc(o-e.length-2*s-1);h.fill(0),h[h.length-1]=1;for(var u=Buffer.concat([f,h,e]),a=Ue.randomBytes(s),p=n(a,u.length,r),c=0;c<u.length;c++)u[c]^=p[c];for(p=n(u,s,r),c=0;c<a.length;c++)a[c]^=p[c];var l=Buffer.alloc(1+a.length+u.length);return l[0]=0,a.copy(l,1),u.copy(l,1+a.length),l},n.prototype.encUnPad=function(e){var r=this.options.encryptionSchemeOptions.hash||"sha1",n=this.options.encryptionSchemeOptions.mgf||t.exports.eme_oaep_mgf1,i=this.options.encryptionSchemeOptions.label||Buffer.alloc(0),o=t.exports.digestLength[r];if(e.length<2*o+2)throw new Error("Error decoding message, the supplied message is not long enough to be a valid OAEP encoded message");for(var s=e.slice(1,o+1),f=e.slice(1+o),h=n(f,o,r),u=0;u<s.length;u++)s[u]^=h[u];for(h=n(s,f.length,r),u=0;u<f.length;u++)f[u]^=h[u];var a=Ue.createHash(r);if(a.update(i),a=a.digest(),f.slice(0,o).toString("hex")!=a.toString("hex"))throw new Error("Error decoding message, the lHash calculated from the label provided and the lHash in the encrypted data do not match.");for(u=o;0===f[u++]&&u<f.length;);if(1!=f[u-1])throw new Error("Error decoding message, there is no padding message separator byte");return f.slice(u)},new n(e,r)}}),_r=(Tr.isEncryption,Tr.isSignature,Tr.digestLength,Tr.eme_oaep_mgf1,Tr.makeScheme,{isEncryption:!1,isSignature:!0});_r.makeScheme=function(t,e){function r(t,e){this.key=t,this.options=e}var n=kr.pkcs1_oaep;return r.prototype.sign=function(t){var e=Ue.createHash(this.options.signingSchemeOptions.hash||"sha1");e.update(t);var r=this.emsa_pss_encode(e.digest(),this.key.keySize-1);return this.key.$doPrivate(new pr(r)).toBuffer(this.key.encryptedDataLength)},r.prototype.verify=function(t,e,r){r&&(e=Buffer.from(e,r)),e=new pr(e);var n=Math.ceil((this.key.keySize-1)/8),i=this.key.$doPublic(e).toBuffer(n),o=Ue.createHash(this.options.signingSchemeOptions.hash||"sha1");return o.update(t),this.emsa_pss_verify(o.digest(),i,this.key.keySize-1)},r.prototype.emsa_pss_encode=function(t,e){var r=this.options.signingSchemeOptions.hash||"sha1",i=this.options.signingSchemeOptions.mgf||n.eme_oaep_mgf1,o=this.options.signingSchemeOptions.saltLength||20,s=n.digestLength[r],f=Math.ceil(e/8);if(f<s+o+2)throw new Error("Output length passed to emBits("+e+") is too small for the options specified("+r+", "+o+"). To fix this issue increase the value of emBits. (minimum size: "+(8*s+8*o+9)+")");var h=Ue.randomBytes(o),u=Buffer.alloc(8+s+o);u.fill(0,0,8),t.copy(u,8),h.copy(u,8+t.length);var a=Ue.createHash(r);a.update(u),a=a.digest();var p=Buffer.alloc(f-h.length-s-2);p.fill(0);var c=Buffer.alloc(p.length+1+h.length);p.copy(c),c[p.length]=1,h.copy(c,p.length+1);for(var l=i(a,c.length,r),y=Buffer.alloc(c.length),m=0;m<l.length;m++)y[m]=c[m]^l[m];var g=8*f-e;y[0]&=255^255>>8-g<<8-g;var d=Buffer.alloc(y.length+a.length+1);return y.copy(d,0),a.copy(d,y.length),d[d.length-1]=188,d},r.prototype.emsa_pss_verify=function(t,e,r){var i=this.options.signingSchemeOptions.hash||"sha1",o=this.options.signingSchemeOptions.mgf||n.eme_oaep_mgf1,s=this.options.signingSchemeOptions.saltLength||20,f=n.digestLength[i],h=Math.ceil(r/8);if(h<f+s+2||188!=e[e.length-1])return!1;var u=Buffer.alloc(h-f-1);e.copy(u,0,0,h-f-1);for(var a=0,p=0,c=8*h-r;p<c;p++)a|=1<<7-p;if(0!=(u[0]&a))return!1;var l=e.slice(h-f-1,h-1),y=o(l,u.length,i);for(p=0;p<u.length;p++)u[p]^=y[p];for(a=255^255>>8-(c=8*h-r)<<8-c,u[0]&=a,p=0;0===u[p]&&p<u.length;p++);if(1!=u[p])return!1;var m=u.slice(u.length-s),g=Buffer.alloc(8+f+s);g.fill(0,0,8),t.copy(g,8),m.copy(g,8+t.length);var d=Ue.createHash(i);return d.update(g),d=d.digest(),l.toString("hex")===d.toString("hex")},new r(t,e)};var Or,kr=i(function(t){t.exports={pkcs1:Er,pkcs1_oaep:Tr,pss:_r,isEncryption:function(e){return t.exports[e]&&t.exports[e].isEncryption},isSignature:function(e){return t.exports[e]&&t.exports[e].isSignature}}}),xr=(kr.pkcs1,kr.pkcs1_oaep,kr.pss,kr.isEncryption,kr.isSignature,function(t,e){return function(t,e){var r=kr.pkcs1.makeScheme(t,e);return{encrypt:function(e,n){var i,o;return n?(i=new pr(r.encPad(e,{type:1})),o=t.$doPrivate(i)):(i=new pr(t.encryptionScheme.encPad(e)),o=t.$doPublic(i)),o.toBuffer(t.encryptedDataLength)},decrypt:function(e,n){var i,o=new pr(e);return n?(i=t.$doPublic(o),r.encUnPad(i.toBuffer(t.encryptedDataLength),{type:1})):(i=t.$doPrivate(o),t.encryptionScheme.encUnPad(i.toBuffer(t.encryptedDataLength)))}}}(t,e)}),Pr=je._,Ir={BigInteger:pr,Key:function(){function t(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}return t.prototype.setOptions=function(t){var e=kr[t.signingScheme],r=kr[t.encryptionScheme];e===r?this.signingScheme=this.encryptionScheme=r.makeScheme(this,t):(this.encryptionScheme=r.makeScheme(this,t),this.signingScheme=e.makeScheme(this,t)),this.encryptEngine=xr(this,t)},t.prototype.generate=function(t,e){var r=t>>1;this.e=C(e,16);for(var n=new pr(e,16);;){for(;this.p=new pr(t-r,1),0!==this.p.subtract(pr.ONE).gcd(n).compareTo(pr.ONE)||!this.p.isProbablePrime(10););for(;this.q=new pr(r,1),0!==this.q.subtract(pr.ONE).gcd(n).compareTo(pr.ONE)||!this.q.isProbablePrime(10););if(0>=this.p.compareTo(this.q)){var i=this.p;this.p=this.q,this.q=i}var o=this.p.subtract(pr.ONE),s=this.q.subtract(pr.ONE),f=o.multiply(s);if(0===f.gcd(n).compareTo(pr.ONE)){if(this.n=this.p.multiply(this.q),this.n.bitLength()<t)continue;this.d=n.modInverse(f),this.dmp1=this.d.mod(o),this.dmq1=this.d.mod(s),this.coeff=this.q.modInverse(this.p);break}}this.$$recalculateCache()},t.prototype.setPrivate=function(t,e,r,n,i,o,s,f){if(!(t&&e&&r&&0<t.length&&(Pr.isNumber(e)||0<e.length)&&0<r.length))throw Error("Invalid RSA private key");this.n=new pr(t),this.e=Pr.isNumber(e)?e:je.get32IntFromBuffer(e,0),this.d=new pr(r),n&&i&&o&&s&&f&&(this.p=new pr(n),this.q=new pr(i),this.dmp1=new pr(o),this.dmq1=new pr(s),this.coeff=new pr(f)),this.$$recalculateCache()},t.prototype.setPublic=function(t,e){if(!(t&&e&&0<t.length&&(Pr.isNumber(e)||0<e.length)))throw Error("Invalid RSA public key");this.n=new pr(t),this.e=Pr.isNumber(e)?e:je.get32IntFromBuffer(e,0),this.$$recalculateCache()},t.prototype.$doPrivate=function(t){if(this.p||this.q)return t.modPow(this.d,this.n);for(var e=t.mod(this.p).modPow(this.dmp1,this.p),r=t.mod(this.q).modPow(this.dmq1,this.q);0>e.compareTo(r);)e=e.add(this.p);return e.subtract(r).multiply(this.coeff).mod(this.p).multiply(this.q).add(r)},t.prototype.$doPublic=function(t){return t.modPowInt(this.e,this.n)},t.prototype.encrypt=function(t,e){var r=[],n=[],i=t.length,o=Math.ceil(i/this.maxMessageLength)||1,s=Math.ceil(i/o||1);if(1==o)r.push(t);else for(var f=0;f<o;f++)r.push(t.slice(f*s,(f+1)*s));for(var h=0;h<r.length;h++)n.push(this.encryptEngine.encrypt(r[h],e));return Buffer.concat(n)},t.prototype.decrypt=function(t,e){if(0<t.length%this.encryptedDataLength)throw Error("Incorrect data or key");for(var r=[],n=0,i=0,o=t.length/this.encryptedDataLength,s=0;s<o;s++)i=(n=s*this.encryptedDataLength)+this.encryptedDataLength,r.push(this.encryptEngine.decrypt(t.slice(n,Math.min(i,t.length)),e));return Buffer.concat(r)},t.prototype.sign=function(){return this.signingScheme.sign.apply(this.signingScheme,arguments)},t.prototype.verify=function(){return this.signingScheme.verify.apply(this.signingScheme,arguments)},t.prototype.isPrivate=function(){return this.n&&this.e&&this.d||!1},t.prototype.isPublic=function(t){return this.n&&this.e&&!(t&&this.d)||!1},x(t.prototype,"keySize",{get:function(){return this.cache.keyBitLength}}),x(t.prototype,"encryptedDataLength",{get:function(){return this.cache.keyByteLength}}),x(t.prototype,"maxMessageLength",{get:function(){return this.encryptionScheme.maxMessageLength()}}),t.prototype.$$recalculateCache=function(){this.cache=this.cache||{},this.cache.keyBitLength=this.n.bitLength(),this.cache.keyByteLength=this.cache.keyBitLength+6>>3},t}()},Dr={newInvalidAsn1Error:function(t){var e=new Error;return e.name="InvalidAsn1Error",e.message=t||"",e}},Lr={EOC:0,Boolean:1,Integer:2,BitString:3,OctetString:4,Null:5,OID:6,ObjectDescriptor:7,External:8,Real:9,Enumeration:10,PDV:11,Utf8String:12,RelativeOID:13,Sequence:16,Set:17,NumericString:18,PrintableString:19,T61String:20,VideotexString:21,IA5String:22,UTCTime:23,GeneralizedTime:24,GraphicString:25,VisibleString:26,GeneralString:28,UniversalString:29,CharacterString:30,BMPString:31,Constructor:32,Context:128},Ar=r.Buffer,Nr={};for(Or in r)r.hasOwnProperty(Or)&&"SlowBuffer"!==Or&&"Buffer"!==Or&&(Nr[Or]=r[Or]);var Rr=Nr.Buffer={};for(Or in Ar)Ar.hasOwnProperty(Or)&&"allocUnsafe"!==Or&&"allocUnsafeSlow"!==Or&&(Rr[Or]=Ar[Or]);if(Nr.Buffer.prototype=Ar.prototype,Rr.from&&Rr.from!==Uint8Array.from||(Rr.from=function(t,e,r){if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type '+typeof t);if(t&&void 0===t.length)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);return Ar(t,e,r)}),Rr.alloc||(Rr.alloc=function(t,e,r){if("number"!=typeof t)throw new TypeError('The "size" argument must be of type number. Received type '+typeof t);if(t<0||t>=2*(1<<30))throw new RangeError('The value "'+t+'" is invalid for option "size"');var n=Ar(t);return e&&0!==e.length?"string"==typeof r?n.fill(e,r):n.fill(e):n.fill(0),n}),!Nr.kStringMaxLength)try{Nr.kStringMaxLength=process.binding("buffer").kStringMaxLength}catch(t){}Nr.constants||(Nr.constants={MAX_LENGTH:Nr.kMaxLength},Nr.kStringMaxLength&&(Nr.constants.MAX_STRING_LENGTH=Nr.kStringMaxLength));var qr=Nr,Mr=qr.Buffer,$r=Dr.newInvalidAsn1Error;function jr(t){if(!t||!Mr.isBuffer(t))throw new TypeError("data must be a node Buffer");this._buf=t,this._size=t.length,this._len=0,this._offset=0}Object.defineProperty(jr.prototype,"length",{enumerable:!0,get:function(){return this._len}}),Object.defineProperty(jr.prototype,"offset",{enumerable:!0,get:function(){return this._offset}}),Object.defineProperty(jr.prototype,"remain",{get:function(){return this._size-this._offset}}),Object.defineProperty(jr.prototype,"buffer",{get:function(){return this._buf.slice(this._offset)}}),jr.prototype.readByte=function(t){if(this._size-this._offset<1)return null;var e=255&this._buf[this._offset];return t||(this._offset+=1),e},jr.prototype.peek=function(){return this.readByte(!0)},jr.prototype.readLength=function(t){if(void 0===t&&(t=this._offset),t>=this._size)return null;var e=255&this._buf[t++];if(null===e)return null;if(128==(128&e)){if(0===(e&=127))throw $r("Indefinite length not supported");if(e>4)throw $r("encoding too long");if(this._size-t<e)return null;this._len=0;for(var r=0;r<e;r++)this._len=(this._len<<8)+(255&this._buf[t++])}else this._len=e;return t},jr.prototype.readSequence=function(t){var e=this.peek();if(null===e)return null;if(void 0!==t&&t!==e)throw $r("Expected 0x"+t.toString(16)+": got 0x"+e.toString(16));var r=this.readLength(this._offset+1);return null===r?null:(this._offset=r,e)},jr.prototype.readInt=function(){return this._readTag(Lr.Integer)},jr.prototype.readBoolean=function(){return 0!==this._readTag(Lr.Boolean)},jr.prototype.readEnumeration=function(){return this._readTag(Lr.Enumeration)},jr.prototype.readString=function(t,e){t||(t=Lr.OctetString);var r=this.peek();if(null===r)return null;if(r!==t)throw $r("Expected 0x"+t.toString(16)+": got 0x"+r.toString(16));var n=this.readLength(this._offset+1);if(null===n)return null;if(this.length>this._size-n)return null;if(this._offset=n,0===this.length)return e?Mr.alloc(0):"";var i=this._buf.slice(this._offset,this._offset+this.length);return this._offset+=this.length,e?i:i.toString("utf8")},jr.prototype.readOID=function(t){t||(t=Lr.OID);var e=this.readString(t,!0);if(null===e)return null;for(var r=[],n=0,i=0;i<e.length;i++){var o=255&e[i];n<<=7,n+=127&o,0==(128&o)&&(r.push(n),n=0)}return n=r.shift(),r.unshift(n%40),r.unshift(n/40>>0),r.join(".")},jr.prototype._readTag=function(t){n.ok(void 0!==t);var e=this.peek();if(null===e)return null;if(e!==t)throw $r("Expected 0x"+t.toString(16)+": got 0x"+e.toString(16));var r=this.readLength(this._offset+1);if(null===r)return null;if(this.length>4)throw $r("Integer too long: "+this.length);if(this.length>this._size-r)return null;this._offset=r;for(var i=this._buf[this._offset],o=0,s=0;s<this.length;s++)o<<=8,o|=255&this._buf[this._offset++];return 128==(128&i)&&4!==s&&(o-=1<<8*s),o>>0};var Ur=jr,Cr=qr.Buffer,Kr=Dr.newInvalidAsn1Error,Vr={size:1024,growthFactor:8};function Fr(t){var e,r;e=Vr,r=t||{},n.ok(e),n.equal(typeof e,"object"),n.ok(r),n.equal(typeof r,"object"),Object.getOwnPropertyNames(e).forEach(function(t){if(!r[t]){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,n)}}),t=r,this._buf=Cr.alloc(t.size||1024),this._size=this._buf.length,this._offset=0,this._options=t,this._seq=[]}Object.defineProperty(Fr.prototype,"buffer",{get:function(){if(this._seq.length)throw Kr(this._seq.length+" unended sequence(s)");return this._buf.slice(0,this._offset)}}),Fr.prototype.writeByte=function(t){if("number"!=typeof t)throw new TypeError("argument must be a Number");this._ensure(1),this._buf[this._offset++]=t},Fr.prototype.writeInt=function(t,e){if("number"!=typeof t)throw new TypeError("argument must be a Number");"number"!=typeof e&&(e=Lr.Integer);for(var r=4;(0==(4286578688&t)||-8388608==(4286578688&t))&&r>1;)r--,t<<=8;if(r>4)throw Kr("BER ints cannot be > 0xffffffff");for(this._ensure(2+r),this._buf[this._offset++]=e,this._buf[this._offset++]=r;r-- >0;)this._buf[this._offset++]=(4278190080&t)>>>24,t<<=8},Fr.prototype.writeNull=function(){this.writeByte(Lr.Null),this.writeByte(0)},Fr.prototype.writeEnumeration=function(t,e){if("number"!=typeof t)throw new TypeError("argument must be a Number");return"number"!=typeof e&&(e=Lr.Enumeration),this.writeInt(t,e)},Fr.prototype.writeBoolean=function(t,e){if("boolean"!=typeof t)throw new TypeError("argument must be a Boolean");"number"!=typeof e&&(e=Lr.Boolean),this._ensure(3),this._buf[this._offset++]=e,this._buf[this._offset++]=1,this._buf[this._offset++]=t?255:0},Fr.prototype.writeString=function(t,e){if("string"!=typeof t)throw new TypeError("argument must be a string (was: "+typeof t+")");"number"!=typeof e&&(e=Lr.OctetString);var r=Cr.byteLength(t);this.writeByte(e),this.writeLength(r),r&&(this._ensure(r),this._buf.write(t,this._offset),this._offset+=r)},Fr.prototype.writeBuffer=function(t,e){if("number"!=typeof e)throw new TypeError("tag must be a number");if(!Cr.isBuffer(t))throw new TypeError("argument must be a buffer");this.writeByte(e),this.writeLength(t.length),this._ensure(t.length),t.copy(this._buf,this._offset,0,t.length),this._offset+=t.length},Fr.prototype.writeStringArray=function(t){if(!t instanceof Array)throw new TypeError("argument must be an Array[String]");var e=this;t.forEach(function(t){e.writeString(t)})},Fr.prototype.writeOID=function(t,e){if("string"!=typeof t)throw new TypeError("argument must be a string");if("number"!=typeof e&&(e=Lr.OID),!/^([0-9]+\.){3,}[0-9]+$/.test(t))throw new Error("argument is not a valid OID string");var r=t.split("."),n=[];n.push(40*parseInt(r[0],10)+parseInt(r[1],10)),r.slice(2).forEach(function(t){!function(t,e){e<128?t.push(e):e<16384?(t.push(e>>>7|128),t.push(127&e)):e<2097152?(t.push(e>>>14|128),t.push(255&(e>>>7|128)),t.push(127&e)):e<268435456?(t.push(e>>>21|128),t.push(255&(e>>>14|128)),t.push(255&(e>>>7|128)),t.push(127&e)):(t.push(255&(e>>>28|128)),t.push(255&(e>>>21|128)),t.push(255&(e>>>14|128)),t.push(255&(e>>>7|128)),t.push(127&e))}(n,parseInt(t,10))});var i=this;this._ensure(2+n.length),this.writeByte(e),this.writeLength(n.length),n.forEach(function(t){i.writeByte(t)})},Fr.prototype.writeLength=function(t){if("number"!=typeof t)throw new TypeError("argument must be a Number");if(this._ensure(4),t<=127)this._buf[this._offset++]=t;else if(t<=255)this._buf[this._offset++]=129,this._buf[this._offset++]=t;else if(t<=65535)this._buf[this._offset++]=130,this._buf[this._offset++]=t>>8,this._buf[this._offset++]=t;else{if(!(t<=16777215))throw Kr("Length too long (> 4 bytes)");this._buf[this._offset++]=131,this._buf[this._offset++]=t>>16,this._buf[this._offset++]=t>>8,this._buf[this._offset++]=t}},Fr.prototype.startSequence=function(t){"number"!=typeof t&&(t=Lr.Sequence|Lr.Constructor),this.writeByte(t),this._seq.push(this._offset),this._ensure(3),this._offset+=3},Fr.prototype.endSequence=function(){var t=this._seq.pop(),e=t+3,r=this._offset-e;if(r<=127)this._shift(e,r,-2),this._buf[t]=r;else if(r<=255)this._shift(e,r,-1),this._buf[t]=129,this._buf[t+1]=r;else if(r<=65535)this._buf[t]=130,this._buf[t+1]=r>>8,this._buf[t+2]=r;else{if(!(r<=16777215))throw Kr("Sequence too long");this._shift(e,r,1),this._buf[t]=131,this._buf[t+1]=r>>16,this._buf[t+2]=r>>8,this._buf[t+3]=r}},Fr.prototype._shift=function(t,e,r){n.ok(void 0!==t),n.ok(void 0!==e),n.ok(r),this._buf.copy(this._buf,t+r,t,t+e),this._offset+=r},Fr.prototype._ensure=function(t){if(n.ok(t),this._size-this._offset<t){var e=this._size*this._options.growthFactor;e-this._offset<t&&(e+=t);var r=Cr.alloc(e);this._buf.copy(r,0,0,this._offset),this._buf=r,this._size=e}};var zr=Fr,Gr=i(function(t){for(var e in t.exports={Reader:Ur,Writer:zr},Lr)Lr.hasOwnProperty(e)&&(t.exports[e]=Lr[e]);for(var r in Dr)Dr.hasOwnProperty(r)&&(t.exports[r]=Dr[r])}),Yr=(Gr.Reader,Gr.Writer,{Ber:Gr,BerReader:Gr.Reader,BerWriter:Gr.Writer}),Hr=i(function(t){var e=Yr.Ber,r=je._,n=je;t.exports={privateExport:function(t,r){r=r||{};var i=t.n.toBuffer(),o=t.d.toBuffer(),s=t.p.toBuffer(),f=t.q.toBuffer(),h=t.dmp1.toBuffer(),u=t.dmq1.toBuffer(),a=t.coeff.toBuffer(),p=i.length+o.length+s.length+f.length+h.length+u.length+a.length+512,c=new e.Writer({size:p});return c.startSequence(),c.writeInt(0),c.writeBuffer(i,2),c.writeInt(t.e),c.writeBuffer(o,2),c.writeBuffer(s,2),c.writeBuffer(f,2),c.writeBuffer(h,2),c.writeBuffer(u,2),c.writeBuffer(a,2),c.endSequence(),"der"===r.type?c.buffer:"-----BEGIN RSA PRIVATE KEY-----\n"+n.linebrk(c.buffer.toString("base64"),64)+"\n-----END RSA PRIVATE KEY-----"},privateImport:function(t,i,o){var s;if("der"!==(o=o||{}).type){if(Buffer.isBuffer(i)&&(i=i.toString("utf8")),!r.isString(i))throw Error("Unsupported key format");var f=n.trimSurroundingText(i,"-----BEGIN RSA PRIVATE KEY-----","-----END RSA PRIVATE KEY-----").replace(/\s+|\n\r|\n|\r$/gm,"");s=Buffer.from(f,"base64")}else{if(!Buffer.isBuffer(i))throw Error("Unsupported key format");s=i}var h=new e.Reader(s);h.readSequence(),h.readString(2,!0),t.setPrivate(h.readString(2,!0),h.readString(2,!0),h.readString(2,!0),h.readString(2,!0),h.readString(2,!0),h.readString(2,!0),h.readString(2,!0),h.readString(2,!0))},publicExport:function(t,r){r=r||{};var i=t.n.toBuffer(),o=i.length+512,s=new e.Writer({size:o});return s.startSequence(),s.writeBuffer(i,2),s.writeInt(t.e),s.endSequence(),"der"===r.type?s.buffer:"-----BEGIN RSA PUBLIC KEY-----\n"+n.linebrk(s.buffer.toString("base64"),64)+"\n-----END RSA PUBLIC KEY-----"},publicImport:function(t,i,o){var s;if("der"!==(o=o||{}).type){if(Buffer.isBuffer(i)&&(i=i.toString("utf8")),r.isString(i)){var f=n.trimSurroundingText(i,"-----BEGIN RSA PUBLIC KEY-----","-----END RSA PUBLIC KEY-----").replace(/\s+|\n\r|\n|\r$/gm,"");s=Buffer.from(f,"base64")}}else{if(!Buffer.isBuffer(i))throw Error("Unsupported key format");s=i}var h=new e.Reader(s);h.readSequence(),t.setPublic(h.readString(2,!0),h.readString(2,!0))},autoImport:function(e,r){return/^[\S\s]*-----BEGIN RSA PRIVATE KEY-----\s*(?=(([A-Za-z0-9+\/=]+\s*)+))\1-----END RSA PRIVATE KEY-----[\S\s]*$/g.test(r)?(t.exports.privateImport(e,r),!0):!!/^[\S\s]*-----BEGIN RSA PUBLIC KEY-----\s*(?=(([A-Za-z0-9+\/=]+\s*)+))\1-----END RSA PUBLIC KEY-----[\S\s]*$/g.test(r)&&(t.exports.publicImport(e,r),!0)}}}),Wr=(Hr.privateExport,Hr.privateImport,Hr.publicExport,Hr.publicImport,Hr.autoImport,i(function(t){var e=Yr.Ber,r=je._,n=je;t.exports={privateExport:function(t,r){r=r||{};var i=t.n.toBuffer(),o=t.d.toBuffer(),s=t.p.toBuffer(),f=t.q.toBuffer(),h=t.dmp1.toBuffer(),u=t.dmq1.toBuffer(),a=t.coeff.toBuffer(),p=i.length+o.length+s.length+f.length+h.length+u.length+a.length+512,c=new e.Writer({size:p});c.startSequence(),c.writeInt(0),c.writeBuffer(i,2),c.writeInt(t.e),c.writeBuffer(o,2),c.writeBuffer(s,2),c.writeBuffer(f,2),c.writeBuffer(h,2),c.writeBuffer(u,2),c.writeBuffer(a,2),c.endSequence();var l=new e.Writer({size:p});return l.startSequence(),l.writeInt(0),l.startSequence(),l.writeOID("1.2.840.113549.1.1.1"),l.writeNull(),l.endSequence(),l.writeBuffer(c.buffer,4),l.endSequence(),"der"===r.type?l.buffer:"-----BEGIN PRIVATE KEY-----\n"+n.linebrk(l.buffer.toString("base64"),64)+"\n-----END PRIVATE KEY-----"},privateImport:function(t,i,o){var s;if("der"!==(o=o||{}).type){if(Buffer.isBuffer(i)&&(i=i.toString("utf8")),!r.isString(i))throw Error("Unsupported key format");var f=n.trimSurroundingText(i,"-----BEGIN PRIVATE KEY-----","-----END PRIVATE KEY-----").replace("-----END PRIVATE KEY-----","").replace(/\s+|\n\r|\n|\r$/gm,"");s=Buffer.from(f,"base64")}else{if(!Buffer.isBuffer(i))throw Error("Unsupported key format");s=i}var h=new e.Reader(s);if(h.readSequence(),h.readInt(0),"1.2.840.113549.1.1.1"!==new e.Reader(h.readString(48,!0)).readOID(6,!0))throw Error("Invalid Public key format");var u=new e.Reader(h.readString(4,!0));u.readSequence(),u.readString(2,!0),t.setPrivate(u.readString(2,!0),u.readString(2,!0),u.readString(2,!0),u.readString(2,!0),u.readString(2,!0),u.readString(2,!0),u.readString(2,!0),u.readString(2,!0))},publicExport:function(t,r){r=r||{};var i=t.n.toBuffer(),o=i.length+512,s=new e.Writer({size:o});s.writeByte(0),s.startSequence(),s.writeBuffer(i,2),s.writeInt(t.e),s.endSequence();var f=new e.Writer({size:o});return f.startSequence(),f.startSequence(),f.writeOID("1.2.840.113549.1.1.1"),f.writeNull(),f.endSequence(),f.writeBuffer(s.buffer,3),f.endSequence(),"der"===r.type?f.buffer:"-----BEGIN PUBLIC KEY-----\n"+n.linebrk(f.buffer.toString("base64"),64)+"\n-----END PUBLIC KEY-----"},publicImport:function(t,i,o){var s;if("der"!==(o=o||{}).type){if(Buffer.isBuffer(i)&&(i=i.toString("utf8")),r.isString(i)){var f=n.trimSurroundingText(i,"-----BEGIN PUBLIC KEY-----","-----END PUBLIC KEY-----").replace(/\s+|\n\r|\n|\r$/gm,"");s=Buffer.from(f,"base64")}}else{if(!Buffer.isBuffer(i))throw Error("Unsupported key format");s=i}var h=new e.Reader(s);if(h.readSequence(),"1.2.840.113549.1.1.1"!==new e.Reader(h.readString(48,!0)).readOID(6,!0))throw Error("Invalid Public key format");var u=new e.Reader(h.readString(3,!0));u.readByte(),u.readSequence(),t.setPublic(u.readString(2,!0),u.readString(2,!0))},autoImport:function(e,r){return/^[\S\s]*-----BEGIN PRIVATE KEY-----\s*(?=(([A-Za-z0-9+\/=]+\s*)+))\1-----END PRIVATE KEY-----[\S\s]*$/g.test(r)?(t.exports.privateImport(e,r),!0):!!/^[\S\s]*-----BEGIN PUBLIC KEY-----\s*(?=(([A-Za-z0-9+\/=]+\s*)+))\1-----END PUBLIC KEY-----[\S\s]*$/g.test(r)&&(t.exports.publicImport(e,r),!0)}}})),Zr=(Wr.privateExport,Wr.privateImport,Wr.publicExport,Wr.publicImport,Wr.autoImport,i(function(t){t.exports={privateExport:function(t){return{n:t.n.toBuffer(),e:t.e,d:t.d.toBuffer(),p:t.p.toBuffer(),q:t.q.toBuffer(),dmp1:t.dmp1.toBuffer(),dmq1:t.dmq1.toBuffer(),coeff:t.coeff.toBuffer()}},privateImport:function(t,e){if(!(e.n&&e.e&&e.d&&e.p&&e.q&&e.dmp1&&e.dmq1&&e.coeff))throw Error("Invalid key data");t.setPrivate(e.n,e.e,e.d,e.p,e.q,e.dmp1,e.dmq1,e.coeff)},publicExport:function(t){return{n:t.n.toBuffer(),e:t.e}},publicImport:function(t,e){if(!e.n||!e.e)throw Error("Invalid key data");t.setPublic(e.n,e.e)},autoImport:function(e,r){return!(!r.n||!r.e||(r.d&&r.p&&r.q&&r.dmp1&&r.dmq1&&r.coeff?(t.exports.privateImport(e,r),0):(t.exports.publicImport(e,r),0)))}}})),Jr=(Zr.privateExport,Zr.privateImport,Zr.publicExport,Zr.publicImport,Zr.autoImport,i(function(t){function e(t){t=t.split("-");for(var e="private",r={type:"default"},n=1;n<t.length;n++)if(t[n])switch(t[n]){case"public":case"private":e=t[n];break;case"pem":r.type=t[n];break;case"der":r.type=t[n]}return{scheme:t[0],keyType:e,keyOpt:r}}t.exports={pkcs1:Hr,pkcs8:Wr,components:Zr,isPrivateExport:function(e){return t.exports[e]&&"function"==typeof t.exports[e].privateExport},isPrivateImport:function(e){return t.exports[e]&&"function"==typeof t.exports[e].privateImport},isPublicExport:function(e){return t.exports[e]&&"function"==typeof t.exports[e].publicExport},isPublicImport:function(e){return t.exports[e]&&"function"==typeof t.exports[e].publicImport},detectAndImport:function(r,n,i){if(void 0===i){for(var o in t.exports)if("function"==typeof t.exports[o].autoImport&&t.exports[o].autoImport(r,n))return!0}else if(i){var s=e(i);if(!t.exports[s.scheme])throw Error("Unsupported key format");"private"===s.keyType?t.exports[s.scheme].privateImport(r,n,s.keyOpt):t.exports[s.scheme].publicImport(r,n,s.keyOpt)}return!1},detectAndExport:function(r,n){if(n){var i=e(n);if(t.exports[i.scheme]){if("private"===i.keyType){if(!r.isPrivate())throw Error("This is not private key");return t.exports[i.scheme].privateExport(r,i.keyOpt)}if(!r.isPublic())throw Error("This is not public key");return t.exports[i.scheme].publicExport(r,i.keyOpt)}throw Error("Unsupported key format")}}}})),Xr=(Jr.pkcs1,Jr.pkcs8,Jr.components,Jr.isPrivateExport,Jr.isPrivateImport,Jr.isPublicExport,Jr.isPublicImport,Jr.detectAndImport,Jr.detectAndExport,je._),Qr=je;return void 0===t.RSA_NO_PADDING&&(t.RSA_NO_PADDING=3),function(){function t(e,i,o){return this instanceof t?(Xr.isObject(i)&&(o=i,i=void 0),this.$options={signingScheme:n,signingSchemeOptions:{hash:"sha256",saltLength:null},encryptionScheme:r,encryptionSchemeOptions:{hash:"sha1",label:null},environment:Qr.detectEnvironment(),rsaUtils:this},this.keyPair=new Ir.Key,this.$cache={},Buffer.isBuffer(e)||Xr.isString(e)?this.importKey(e,i):Xr.isObject(e)&&this.generateKeyPair(e.b,e.e),void this.setOptions(o)):new t(e,i,o)}var e={node10:["md4","md5","ripemd160","sha1","sha224","sha256","sha384","sha512"],node:["md4","md5","ripemd160","sha1","sha224","sha256","sha384","sha512"],iojs:["md4","md5","ripemd160","sha1","sha224","sha256","sha384","sha512"],browser:["md5","ripemd160","sha1","sha256","sha512"]},r="pkcs1_oaep",n="pkcs1",i={private:"pkcs1-private-pem","private-der":"pkcs1-private-der",public:"pkcs8-public-pem","public-der":"pkcs8-public-der"};return t.prototype.setOptions=function(t){if((t=t||{}).environment&&(this.$options.environment=t.environment),t.signingScheme){if(Xr.isString(t.signingScheme)){var i=t.signingScheme.toLowerCase().split("-");1==i.length?-1<e.node.indexOf(i[0])?(this.$options.signingSchemeOptions={hash:i[0]},this.$options.signingScheme=n):(this.$options.signingScheme=i[0],this.$options.signingSchemeOptions={hash:null}):(this.$options.signingSchemeOptions={hash:i[1]},this.$options.signingScheme=i[0])}else Xr.isObject(t.signingScheme)&&(this.$options.signingScheme=t.signingScheme.scheme||n,this.$options.signingSchemeOptions=Xr.omit(t.signingScheme,"scheme"));if(!kr.isSignature(this.$options.signingScheme))throw Error("Unsupported signing scheme");if(this.$options.signingSchemeOptions.hash&&-1===e[this.$options.environment].indexOf(this.$options.signingSchemeOptions.hash))throw Error("Unsupported hashing algorithm for "+this.$options.environment+" environment")}if(t.encryptionScheme){if(Xr.isString(t.encryptionScheme)?(this.$options.encryptionScheme=t.encryptionScheme.toLowerCase(),this.$options.encryptionSchemeOptions={}):Xr.isObject(t.encryptionScheme)&&(this.$options.encryptionScheme=t.encryptionScheme.scheme||r,this.$options.encryptionSchemeOptions=Xr.omit(t.encryptionScheme,"scheme")),!kr.isEncryption(this.$options.encryptionScheme))throw Error("Unsupported encryption scheme");if(this.$options.encryptionSchemeOptions.hash&&-1===e[this.$options.environment].indexOf(this.$options.encryptionSchemeOptions.hash))throw Error("Unsupported hashing algorithm for "+this.$options.environment+" environment")}this.keyPair.setOptions(this.$options)},t.prototype.generateKeyPair=function(t,e){if(e=e||65537,0!=(t=t||2048)%8)throw Error("Key size must be a multiple of 8.");return this.keyPair.generate(t,e.toString(16)),this.$cache={},this},t.prototype.importKey=function(t,e){if(!t)throw Error("Empty key given");if(e&&(e=i[e]||e),!Jr.detectAndImport(this.keyPair,t,e)&&void 0===e)throw Error("Key format must be specified");return this.$cache={},this},t.prototype.exportKey=function(t){return t=i[t=t||"private"]||t,this.$cache[t]||(this.$cache[t]=Jr.detectAndExport(this.keyPair,t)),this.$cache[t]},t.prototype.isPrivate=function(){return this.keyPair.isPrivate()},t.prototype.isPublic=function(t){return this.keyPair.isPublic(t)},t.prototype.isEmpty=function(){return!(this.keyPair.n||this.keyPair.e||this.keyPair.d)},t.prototype.encrypt=function(t,e,r){return this.$$encryptKey(!1,t,e,r)},t.prototype.decrypt=function(t,e){return this.$$decryptKey(!1,t,e)},t.prototype.encryptPrivate=function(t,e,r){return this.$$encryptKey(!0,t,e,r)},t.prototype.decryptPublic=function(t,e){return this.$$decryptKey(!0,t,e)},t.prototype.$$encryptKey=function(t,e,r,n){try{var i=this.keyPair.encrypt(this.$getDataForEncrypt(e,n),t);return"buffer"!=r&&r?i.toString(r):i}catch(t){throw console.log(t),Error("Error during encryption. Original error: "+t)}},t.prototype.$$decryptKey=function(t,e,r){try{e=Xr.isString(e)?Buffer.from(e,"base64"):e;var n=this.keyPair.decrypt(e,t);if(null===n)throw Error("Key decrypt method returns null.");return this.$getDecryptedData(n,r)}catch(t){throw Error("Error during decryption (probably incorrect key). Original error: "+t)}},t.prototype.sign=function(t,e,r){if(!this.isPrivate())throw Error("This is not private key");var n=this.keyPair.sign(this.$getDataForEncrypt(t,r));return e&&"buffer"!=e&&(n=n.toString(e)),n},t.prototype.verify=function(t,e,r,n){if(!this.isPublic())throw Error("This is not public key");return n=n&&"buffer"!=n?n:null,this.keyPair.verify(this.$getDataForEncrypt(t,r),e,n)},t.prototype.getKeySize=function(){return this.keyPair.keySize},t.prototype.getMaxMessageSize=function(){return this.keyPair.maxMessageLength},t.prototype.$getDataForEncrypt=function(t,e){if(Xr.isString(t)||Xr.isNumber(t))return Buffer.from(""+t,e||"utf8");if(Buffer.isBuffer(t))return t;if(Xr.isObject(t))return Buffer.from(f(t));throw Error("Unexpected data type")},t.prototype.$getDecryptedData=function(t,e){return"buffer"==(e=e||"buffer")?t:"json"==e?JSON.parse(t.toString()):t.toString(e)},t}()});
//# sourceMappingURL=mini-rsa.common.js.map
