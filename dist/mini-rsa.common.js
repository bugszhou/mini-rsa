!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("constants"),require("crypto"),require("create-hash"),require("buffer"),require("assert")):"function"==typeof define&&define.amd?define(["constants","crypto","create-hash","buffer","assert"],e):(t=t||self,function(){var r=t["mini-rsa"],n=t["mini-rsa"]=e(t.constants,t.crypto,t.createHash,t.buffer,t.assert);n.noConflict=function(){return t["mini-rsa"]=r,n}}())}(this,function(t,e,r,n,i){"use strict";function o(t,e){return t(e={exports:{}},e.exports),e.exports}t=t&&t.hasOwnProperty("default")?t.default:t,e=e&&e.hasOwnProperty("default")?e.default:e,r=r&&r.hasOwnProperty("default")?r.default:r,n=n&&n.hasOwnProperty("default")?n.default:n,i=i&&i.hasOwnProperty("default")?i.default:i;var s=o(function(t){var e=t.exports={version:"2.6.9"};"number"==typeof __e&&(__e=e)}),f=(s.version,s.JSON||(s.JSON={stringify:JSON.stringify})),h=function(t){return f.stringify.apply(f,arguments)},u=o(function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)}),a=function(t,e,r){if(function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!")}(t),void 0===e)return t;switch(r){case 1:return function(r){return t.call(e,r)};case 2:return function(r,n){return t.call(e,r,n)};case 3:return function(r,n,i){return t.call(e,r,n,i)}}return function(){return t.apply(e,arguments)}},p=function(t){return"object"==typeof t?null!==t:"function"==typeof t},c=function(t){if(!p(t))throw TypeError(t+" is not an object!");return t},l=function(t){try{return!!t()}catch(t){return!0}},y=!l(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),m=u.document,g=p(m)&&p(m.createElement),d=function(t){return g?m.createElement(t):{}},v=!y&&!l(function(){return 7!=Object.defineProperty(d("div"),"a",{get:function(){return 7}}).a}),b=function(t,e){if(!p(t))return t;var r,n;if(e&&"function"==typeof(r=t.toString)&&!p(n=r.call(t)))return n;if("function"==typeof(r=t.valueOf)&&!p(n=r.call(t)))return n;if(!e&&"function"==typeof(r=t.toString)&&!p(n=r.call(t)))return n;throw TypeError("Can't convert object to primitive value")},S=Object.defineProperty,w={f:y?Object.defineProperty:function(t,e,r){if(c(t),e=b(e,!0),c(r),v)try{return S(t,e,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[e]=r.value),t}},B=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},E=y?function(t,e,r){return w.f(t,e,B(1,r))}:function(t,e,r){return t[e]=r,t},T={}.hasOwnProperty,_=function(t,e){return T.call(t,e)},O=function(t,e,r){var n,i,o,f=t&O.F,h=t&O.G,p=t&O.S,c=t&O.P,l=t&O.B,y=t&O.W,m=h?s:s[e]||(s[e]={}),g=m.prototype,d=h?u:p?u[e]:(u[e]||{}).prototype;for(n in h&&(r=e),r)(i=!f&&d&&void 0!==d[n])&&_(m,n)||(o=i?d[n]:r[n],m[n]=h&&"function"!=typeof d[n]?r[n]:l&&i?a(o,u):y&&d[n]==o?function(t){var e=function(e,r,n){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,r)}return new t(e,r,n)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(o):c&&"function"==typeof o?a(Function.call,o):o,c&&((m.virtual||(m.virtual={}))[n]=o,t&O.R&&g&&!g[n]&&E(g,n,o)))};O.F=1,O.G=2,O.S=4,O.P=8,O.B=16,O.W=32,O.U=64,O.R=128;var k=O;k(k.S+k.F*!y,"Object",{defineProperty:w.f});var x=s.Object,P=function(t,e,r){return x.defineProperty(t,e,r)},I=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t},D="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff",L="["+D+"]",A=RegExp("^"+L+L+"*"),N=RegExp(L+L+"*$"),R=function(t,e,r){var n={},i=l(function(){return!!D[t]()||"​"!="​"[t]()}),o=n[t]=i?e(q):D[t];r&&(n[r]=o),k(k.P+k.F*i,"String",n)},q=R.trim=function(t,e){return t=String(I(t)),1&e&&(t=t.replace(A,"")),2&e&&(t=t.replace(N,"")),t},M=R,$=u.parseInt,j=M.trim,U=/^[-+]?0[xX]/,C=8!==$(D+"08")||22!==$(D+"0x16")?function(t,e){var r=j(String(t),3);return $(r,e>>>0||(U.test(r)?16:10))}:$;k(k.G+k.F*(parseInt!=C),{parseInt:C});var K=s.parseInt,V=u.parseFloat,F=M.trim,z=1/V(D+"-0")!=-1/0?function(t){var e=F(String(t),3),r=V(e);return 0===r&&"-"==e.charAt(0)?-0:r}:V;k(k.G+k.F*(parseFloat!=z),{parseFloat:z});var G,Y=s.parseFloat,H=Math.ceil,W=Math.floor,Z=function(t){return isNaN(t=+t)?0:(t>0?W:H)(t)},J=E,X={}.toString,Q=function(t){return X.call(t).slice(8,-1)},tt=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==Q(t)?t.split(""):Object(t)},et=function(t){return tt(I(t))},rt=Math.min,nt=Math.max,it=Math.min,ot=o(function(t){var e=u["__core-js_shared__"]||(u["__core-js_shared__"]={});(t.exports=function(t,r){return e[t]||(e[t]=void 0!==r?r:{})})("versions",[]).push({version:s.version,mode:"pure",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})}),st=0,ft=Math.random(),ht=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++st+ft).toString(36))},ut=ot("keys"),at=function(t){return ut[t]||(ut[t]=ht(t))},pt=(G=!1,function(t,e,r){var n,i,o=et(t),s=(n=o.length)>0?rt(Z(n),9007199254740991):0,f=function(t,e){return(t=Z(t))<0?nt(t+e,0):it(t,e)}(r,s);if(G&&e!=e){for(;s>f;)if((i=o[f++])!=i)return!0}else for(;s>f;f++)if((G||f in o)&&o[f]===e)return G||f||0;return!G&&-1}),ct=at("IE_PROTO"),lt=function(t,e){var r,n=et(t),i=0,o=[];for(r in n)r!=ct&&_(n,r)&&o.push(r);for(;e.length>i;)_(n,r=e[i++])&&(~pt(o,r)||o.push(r));return o},yt="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),mt=Object.keys||function(t){return lt(t,yt)},gt=y?Object.defineProperties:function(t,e){c(t);for(var r,n=mt(e),i=n.length,o=0;i>o;)w.f(t,r=n[o++],e[r]);return t},dt=u.document,vt=dt&&dt.documentElement,bt=at("IE_PROTO"),St=function(){},wt=function(){var t,e=d("iframe"),r=yt.length;for(e.style.display="none",vt.appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),wt=t.F;r--;)delete wt.prototype[yt[r]];return wt()},Bt=Object.create||function(t,e){var r;return null!==t?(St.prototype=c(t),r=new St,St.prototype=null,r[bt]=t):r=wt(),void 0===e?r:gt(r,e)},Et=o(function(t){var e=ot("wks"),r=u.Symbol,n="function"==typeof r;(t.exports=function(t){return e[t]||(e[t]=n&&r[t]||(n?r:ht)("Symbol."+t))}).store=e}),Tt=w.f,_t=Et("toStringTag"),Ot=function(t,e,r){t&&!_(t=r?t:t.prototype,_t)&&Tt(t,_t,{configurable:!0,value:e})},kt={};E(kt,Et("iterator"),function(){return this});var xt,Pt=function(t,e,r){t.prototype=Bt(kt,{next:B(1,r)}),Ot(t,e+" Iterator")},It=function(t){return Object(I(t))},Dt=at("IE_PROTO"),Lt=Object.prototype,At=Object.getPrototypeOf||function(t){return t=It(t),_(t,Dt)?t[Dt]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?Lt:null},Nt=Et("iterator"),Rt=!([].keys&&"next"in[].keys()),qt=function(t,e,r,n,i,o,s){Pt(r,e,n);var f,h,u,a=function(t){if(!Rt&&t in y)return y[t];switch(t){case"keys":case"values":return function(){return new r(this,t)}}return function(){return new r(this,t)}},p=e+" Iterator",c="values"==i,l=!1,y=t.prototype,m=y[Nt]||y["@@iterator"]||i&&y[i],g=m||a(i),d=i?c?a("entries"):g:void 0,v="Array"==e&&y.entries||m;if(v&&(u=At(v.call(new t)))!==Object.prototype&&u.next&&Ot(u,p,!0),c&&m&&"values"!==m.name&&(l=!0,g=function(){return m.call(this)}),s&&(Rt||l||!y[Nt])&&E(y,Nt,g),i)if(f={values:c?g:a("values"),keys:o?g:a("keys"),entries:d},s)for(h in f)h in y||J(y,h,f[h]);else k(k.P+k.F*(Rt||l),e,f);return f},Mt=(xt=!0,function(t,e){var r,n,i=String(I(t)),o=Z(e),s=i.length;return o<0||o>=s?xt?"":void 0:(r=i.charCodeAt(o))<55296||r>56319||o+1===s||(n=i.charCodeAt(o+1))<56320||n>57343?xt?i.charAt(o):r:xt?i.slice(o,o+2):n-56320+(r-55296<<10)+65536});qt(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,r=this._i;return r>=e.length?{value:void 0,done:!0}:(t=Mt(e,r),this._i+=t.length,{value:t,done:!1})});for(var $t=function(t,e){return{value:e,done:!!t}},jt=(qt(Array,"Array",function(t,e){this._t=et(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,r=this._i++;return!t||r>=t.length?(this._t=void 0,$t(1)):$t(0,"keys"==e?r:"values"==e?t[r]:[r,t[r]])},"values"),Et("toStringTag")),Ut="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),Ct=0;Ct<Ut.length;Ct++){var Kt=Ut[Ct],Vt=u[Kt],Ft=Vt&&Vt.prototype;Ft&&!Ft[jt]&&E(Ft,jt,Kt)}var zt={f:Et},Gt=zt.f("iterator"),Yt=o(function(t){var e=ht("meta"),r=w.f,n=0,i=Object.isExtensible||function(){return!0},o=!l(function(){return i(Object.preventExtensions({}))}),s=function(t){r(t,e,{value:{i:"O"+ ++n,w:{}}})},f=t.exports={KEY:e,NEED:!1,fastKey:function(t,r){if(!p(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!_(t,e)){if(!i(t))return"F";if(!r)return"E";s(t)}return t[e].i},getWeak:function(t,r){if(!_(t,e)){if(!i(t))return!0;if(!r)return!1;s(t)}return t[e].w},onFreeze:function(t){return o&&f.NEED&&i(t)&&!_(t,e)&&s(t),t}}}),Ht=(Yt.KEY,Yt.NEED,Yt.fastKey,Yt.getWeak,Yt.onFreeze,w.f),Wt=function(t){var e=s.Symbol||(s.Symbol={});"_"==t.charAt(0)||t in e||Ht(e,t,{value:zt.f(t)})},Zt={f:Object.getOwnPropertySymbols},Jt={f:{}.propertyIsEnumerable},Xt=Array.isArray||function(t){return"Array"==Q(t)},Qt=yt.concat("length","prototype"),te={f:Object.getOwnPropertyNames||function(t){return lt(t,Qt)}},ee=te.f,re={}.toString,ne="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],ie={f:function(t){return ne&&"[object Window]"==re.call(t)?function(t){try{return ee(t)}catch(t){return ne.slice()}}(t):ee(et(t))}},oe=Object.getOwnPropertyDescriptor,se={f:y?oe:function(t,e){if(t=et(t),e=b(e,!0),v)try{return oe(t,e)}catch(t){}if(_(t,e))return B(!Jt.f.call(t,e),t[e])}},fe=Yt.KEY,he=se.f,ue=w.f,ae=ie.f,pe=u.Symbol,ce=u.JSON,le=ce&&ce.stringify,ye=Et("_hidden"),me=Et("toPrimitive"),ge={}.propertyIsEnumerable,de=ot("symbol-registry"),ve=ot("symbols"),be=ot("op-symbols"),Se=Object.prototype,we="function"==typeof pe&&!!Zt.f,Be=u.QObject,Ee=!Be||!Be.prototype||!Be.prototype.findChild,Te=y&&l(function(){return 7!=Bt(ue({},"a",{get:function(){return ue(this,"a",{value:7}).a}})).a})?function(t,e,r){var n=he(Se,e);n&&delete Se[e],ue(t,e,r),n&&t!==Se&&ue(Se,e,n)}:ue,_e=function(t){var e=ve[t]=Bt(pe.prototype);return e._k=t,e},Oe=we&&"symbol"==typeof pe.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof pe},ke=function(t,e,r){return t===Se&&ke(be,e,r),c(t),e=b(e,!0),c(r),_(ve,e)?(r.enumerable?(_(t,ye)&&t[ye][e]&&(t[ye][e]=!1),r=Bt(r,{enumerable:B(0,!1)})):(_(t,ye)||ue(t,ye,B(1,{})),t[ye][e]=!0),Te(t,e,r)):ue(t,e,r)},xe=function(t,e){c(t);for(var r,n=function(t){var e=mt(t),r=Zt.f;if(r)for(var n,i=r(t),o=Jt.f,s=0;i.length>s;)o.call(t,n=i[s++])&&e.push(n);return e}(e=et(e)),i=0,o=n.length;o>i;)ke(t,r=n[i++],e[r]);return t},Pe=function(t){var e=ge.call(this,t=b(t,!0));return!(this===Se&&_(ve,t)&&!_(be,t))&&(!(e||!_(this,t)||!_(ve,t)||_(this,ye)&&this[ye][t])||e)},Ie=function(t,e){if(t=et(t),e=b(e,!0),t!==Se||!_(ve,e)||_(be,e)){var r=he(t,e);return!r||!_(ve,e)||_(t,ye)&&t[ye][e]||(r.enumerable=!0),r}},De=function(t){for(var e,r=ae(et(t)),n=[],i=0;r.length>i;)_(ve,e=r[i++])||e==ye||e==fe||n.push(e);return n},Le=function(t){for(var e,r=t===Se,n=ae(r?be:et(t)),i=[],o=0;n.length>o;)!_(ve,e=n[o++])||r&&!_(Se,e)||i.push(ve[e]);return i};we||(J((pe=function(){if(this instanceof pe)throw TypeError("Symbol is not a constructor!");var t=ht(arguments.length>0?arguments[0]:void 0),e=function(r){this===Se&&e.call(be,r),_(this,ye)&&_(this[ye],t)&&(this[ye][t]=!1),Te(this,t,B(1,r))};return y&&Ee&&Te(Se,t,{configurable:!0,set:e}),_e(t)}).prototype,"toString",function(){return this._k}),se.f=Ie,w.f=ke,te.f=ie.f=De,Jt.f=Pe,Zt.f=Le,zt.f=function(t){return _e(Et(t))}),k(k.G+k.W+k.F*!we,{Symbol:pe});for(var Ae="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),Ne=0;Ae.length>Ne;)Et(Ae[Ne++]);for(var Re=mt(Et.store),qe=0;Re.length>qe;)Wt(Re[qe++]);k(k.S+k.F*!we,"Symbol",{for:function(t){return _(de,t+="")?de[t]:de[t]=pe(t)},keyFor:function(t){if(!Oe(t))throw TypeError(t+" is not a symbol!");for(var e in de)if(de[e]===t)return e},useSetter:function(){Ee=!0},useSimple:function(){Ee=!1}}),k(k.S+k.F*!we,"Object",{create:function(t,e){return void 0===e?Bt(t):xe(Bt(t),e)},defineProperty:ke,defineProperties:xe,getOwnPropertyDescriptor:Ie,getOwnPropertyNames:De,getOwnPropertySymbols:Le});var Me=l(function(){Zt.f(1)});k(k.S+k.F*Me,"Object",{getOwnPropertySymbols:function(t){return Zt.f(It(t))}}),ce&&k(k.S+k.F*(!we||l(function(){var t=pe();return"[null]"!=le([t])||"{}"!=le({a:t})||"{}"!=le(Object(t))})),"JSON",{stringify:function(t){for(var e,r,n=[t],i=1;arguments.length>i;)n.push(arguments[i++]);if(r=e=n[1],(p(e)||void 0!==t)&&!Oe(t))return Xt(e)||(e=function(t,e){if("function"==typeof r&&(e=r.call(this,t,e)),!Oe(e))return e}),n[1]=e,le.apply(ce,n)}}),pe.prototype[me]||E(pe.prototype,me,pe.prototype.valueOf),Ot(pe,"Symbol"),Ot(Math,"Math",!0),Ot(u.JSON,"JSON",!0),Wt("asyncIterator"),Wt("observable");var $e=s.Symbol,je=o(function(t){function e(t){return(e="function"==typeof $e&&"symbol"==typeof Gt?function(t){return typeof t}:function(t){return t&&"function"==typeof $e&&t.constructor===$e&&t!==$e.prototype?"symbol":typeof t})(t)}function r(n){return"function"==typeof $e&&"symbol"===e(Gt)?t.exports=r=function(t){return e(t)}:t.exports=r=function(t){return t&&"function"==typeof $e&&t.constructor===$e&&t!==$e.prototype?"symbol":e(t)},r(n)}t.exports=r}),Ue={linebrk:function(t,e){for(var r="",n=0;n+e<t.length;)r+=t.substring(n,n+e)+"\n",n+=e;return r+t.substring(n,t.length)},detectEnvironment:function(){return"browser"},get32IntFromBuffer:function(t,e){e=e||0;var r;if(0<(r=t.length-e)){if(4<=r)return t.readUInt32BE(e);for(var n=0,i=e+r,o=0;i>e;i--,o+=2)n+=t[i-1]*Math.pow(16,o);return n}return NaN},_:{isObject:function(t){var e=je(t);return!!t&&("object"==e||"function"==e)},isString:function(t){return"string"==typeof t||t instanceof String},isNumber:function(t){return"number"==typeof t||!isNaN(Y(t))&&isFinite(t)},omit:function(t,e){var r={};for(var n in t)t.hasOwnProperty(n)&&n!==e&&(r[n]=t[n]);return r}},trimSurroundingText:function(t,e,r){var n=0,i=t.length,o=t.indexOf(e);0<=o&&(n=o+e.length);var s=t.indexOf(r,o);return 0<=s&&(i=s),t.substring(n,i)}},Ce=Ue._;function Ke(t,e){null!=t&&("number"==typeof t?this.fromNumber(t,e):Buffer.isBuffer(t)?this.fromBuffer(t):null==e&&"string"!=typeof t?this.fromByteArray(t):this.fromString(t,e))}function Ve(){return new Ke(null)}Ke.prototype.am=function(t,e,r,n,i,o){for(var s=16383&e,f=e>>14;0<=--o;){var h=16383&this[t],u=this[t++]>>14,a=f*h+u*s;i=((h=s*h+((16383&a)<<14)+r[n]+i)>>28)+(a>>14)+f*u,r[n++]=268435455&h}return i},Ke.prototype.DB=28,Ke.prototype.DM=268435455,Ke.prototype.DV=1<<28;Ke.prototype.FV=Math.pow(2,52),Ke.prototype.F1=24,Ke.prototype.F2=4;var Fe,ze,Ge="0123456789abcdefghijklmnopqrstuvwxyz",Ye=[];for(Fe="0".charCodeAt(0),ze=0;9>=ze;++ze)Ye[Fe++]=ze;for(Fe="a".charCodeAt(0),ze=10;36>ze;++ze)Ye[Fe++]=ze;for(Fe="A".charCodeAt(0),ze=10;36>ze;++ze)Ye[Fe++]=ze;function He(t){return Ge.charAt(t)}function We(t,e){var r=Ye[t.charCodeAt(e)];return null==r?-1:r}function Ze(t){var e=Ve();return e.fromInt(t),e}function Je(t){var e,r=1;return 0!=(e=t>>>16)&&(t=e,r+=16),0!=(e=t>>8)&&(t=e,r+=8),0!=(e=t>>4)&&(t=e,r+=4),0!=(e=t>>2)&&(t=e,r+=2),0!=(e=t>>1)&&(t=e,r+=1),r}function Xe(t){this.m=t}function Qe(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function tr(t,e){return t&e}function er(t,e){return t|e}function rr(t,e){return t^e}function nr(t,e){return t&~e}function ir(t){if(0===t)return-1;var e=0;return 0==(65535&t)&&(t>>=16,e+=16),0==(255&t)&&(t>>=8,e+=8),0==(15&t)&&(t>>=4,e+=4),0==(3&t)&&(t>>=2,e+=2),0==(1&t)&&++e,e}function or(t){for(var e=0;0!=t;)t&=t-1,++e;return e}function sr(){}function fr(t){return t}function hr(t){this.r2=Ve(),this.q3=Ve(),Ke.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}Xe.prototype.convert=function(t){return 0>t.s||0<=t.compareTo(this.m)?t.mod(this.m):t},Xe.prototype.revert=function(t){return t},Xe.prototype.reduce=function(t){t.divRemTo(this.m,null,t)},Xe.prototype.mulTo=function(t,e,r){t.multiplyTo(e,r),this.reduce(r)},Xe.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},Qe.prototype.convert=function(t){var e=Ve();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),0>t.s&&0<e.compareTo(Ke.ZERO)&&this.m.subTo(e,e),e},Qe.prototype.revert=function(t){var e=Ve();return t.copyTo(e),this.reduce(e),e},Qe.prototype.reduce=function(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=32767&t[e],n=r*this.mpl+((r*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(t[r=e+this.m.t]+=this.m.am(0,n,t,e,0,this.m.t);t[r]>=t.DV;)t[r]-=t.DV,t[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),0<=t.compareTo(this.m)&&t.subTo(this.m,t)},Qe.prototype.mulTo=function(t,e,r){t.multiplyTo(e,r),this.reduce(r)},Qe.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},sr.prototype.convert=fr,sr.prototype.revert=fr,sr.prototype.mulTo=function(t,e,r){t.multiplyTo(e,r)},sr.prototype.sqrTo=function(t,e){t.squareTo(e)},hr.prototype.convert=function(t){if(0>t.s||t.t>2*this.m.t)return t.mod(this.m);if(0>t.compareTo(this.m))return t;var e=Ve();return t.copyTo(e),this.reduce(e),e},hr.prototype.revert=function(t){return t},hr.prototype.reduce=function(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);0>t.compareTo(this.r2);)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);0<=t.compareTo(this.m);)t.subTo(this.m,t)},hr.prototype.mulTo=function(t,e,r){t.multiplyTo(e,r),this.reduce(r)},hr.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)};var ur=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],ar=(1<<26)/ur[ur.length-1];Ke.prototype.copyTo=function(t){for(var e=this.t-1;0<=e;--e)t[e]=this[e];t.t=this.t,t.s=this.s},Ke.prototype.fromInt=function(t){this.t=1,this.s=0>t?-1:0,0<t?this[0]=t:-1>t?this[0]=t+DV:this.t=0},Ke.prototype.fromString=function(t,e,r){var n;switch(e){case 2:n=1;break;case 4:n=2;break;case 8:n=3;break;case 16:n=4;break;case 32:n=5;break;case 256:n=8;break;default:return void this.fromRadix(t,e)}this.t=0,this.s=0;for(var i=t.length,o=!1,s=0;0<=--i;){var f=8==n?255&t[i]:We(t,i);0>f?"-"==t.charAt(i)&&(o=!0):(o=!1,0===s?this[this.t++]=f:s+n>this.DB?(this[this.t-1]|=(f&(1<<this.DB-s)-1)<<s,this[this.t++]=f>>this.DB-s):this[this.t-1]|=f<<s,(s+=n)>=this.DB&&(s-=this.DB))}r||8!=n||0==(128&t[0])||(this.s=-1,0<s&&(this[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),o&&Ke.ZERO.subTo(this,this)},Ke.prototype.fromByteArray=function(t,e){this.fromString(t,256,e)},Ke.prototype.fromBuffer=function(t){this.fromString(t,256,!0)},Ke.prototype.clamp=function(){for(var t=this.s&this.DM;0<this.t&&this[this.t-1]==t;)--this.t},Ke.prototype.dlShiftTo=function(t,e){var r;for(r=this.t-1;0<=r;--r)e[r+t]=this[r];for(r=t-1;0<=r;--r)e[r]=0;e.t=this.t+t,e.s=this.s},Ke.prototype.drShiftTo=function(t,e){for(var r=t;r<this.t;++r)e[r-t]=this[r];e.t=Math.max(this.t-t,0),e.s=this.s},Ke.prototype.lShiftTo=function(t,e){var r,n=t%this.DB,i=this.DB-n,o=Math.floor(t/this.DB),s=this.s<<n&this.DM;for(r=this.t-1;0<=r;--r)e[r+o+1]=this[r]>>i|s,s=(this[r]&(1<<i)-1)<<n;for(r=o-1;0<=r;--r)e[r]=0;e[o]=s,e.t=this.t+o+1,e.s=this.s,e.clamp()},Ke.prototype.rShiftTo=function(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t)e.t=0;else{var n=t%this.DB,i=this.DB-n,o=(1<<n)-1;e[0]=this[r]>>n;for(var s=r+1;s<this.t;++s)e[s-r-1]|=(this[s]&o)<<i,e[s-r]=this[s]>>n;0<n&&(e[this.t-r-1]|=(this.s&o)<<i),e.t=this.t-r,e.clamp()}},Ke.prototype.subTo=function(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this[r]-t[r],e[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this[r],e[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t[r],e[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=0>n?-1:0,-1>n?e[r++]=this.DV+n:0<n&&(e[r++]=n),e.t=r,e.clamp()},Ke.prototype.multiplyTo=function(t,e){var r=this.abs(),n=t.abs(),i=r.t;for(e.t=i+n.t;0<=--i;)e[i]=0;for(i=0;i<n.t;++i)e[i+r.t]=r.am(0,n[i],e,i,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&Ke.ZERO.subTo(e,e)},Ke.prototype.squareTo=function(t){for(var e=this.abs(),r=t.t=2*e.t;0<=--r;)t[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e[r],t,2*r,0,1);(t[r+e.t]+=e.am(r+1,2*e[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t[r+e.t]-=e.DV,t[r+e.t+1]=1)}0<t.t&&(t[t.t-1]+=e.am(r,e[r],t,2*r,0,1)),t.s=0,t.clamp()},Ke.prototype.divRemTo=function(t,e,r){var n=t.abs();if(!(0>=n.t)){var i=this.abs();if(i.t<n.t)return null!=e&&e.fromInt(0),void(null!=r&&this.copyTo(r));null==r&&(r=Ve());var o=Ve(),s=this.s,f=t.s,h=this.DB-Je(n[n.t-1]);0<h?(n.lShiftTo(h,o),i.lShiftTo(h,r)):(n.copyTo(o),i.copyTo(r));var u=o.t,a=o[u-1];if(0!==a){var p=a*(1<<this.F1)+(1<u?o[u-2]>>this.F2:0),c=this.FV/p,l=(1<<this.F1)/p,y=1<<this.F2,m=r.t,g=m-u,d=null==e?Ve():e;for(o.dlShiftTo(g,d),0<=r.compareTo(d)&&(r[r.t++]=1,r.subTo(d,r)),Ke.ONE.dlShiftTo(u,d),d.subTo(o,o);o.t<u;)o[o.t++]=0;for(;0<=--g;){var v=r[--m]==a?this.DM:Math.floor(r[m]*c+(r[m-1]+y)*l);if((r[m]+=o.am(0,v,r,g,0,u))<v)for(o.dlShiftTo(g,d),r.subTo(d,r);r[m]<--v;)r.subTo(d,r)}null!=e&&(r.drShiftTo(u,e),s!=f&&Ke.ZERO.subTo(e,e)),r.t=u,r.clamp(),0<h&&r.rShiftTo(h,r),0>s&&Ke.ZERO.subTo(r,r)}}},Ke.prototype.invDigit=function(){if(1>this.t)return 0;var t=this[0];if(0==(1&t))return 0;var e=3&t;return 0<(e=(e=65535&(e=255&(e=15&e*(2-(15&t)*e))*(2-(255&t)*e))*(2-(65535&(65535&t)*e)))*(2-t*e%this.DV)%this.DV)?this.DV-e:-e},Ke.prototype.isEven=function(){return 0===(0<this.t?1&this[0]:this.s)},Ke.prototype.exp=function(t,e){if(4294967295<t||1>t)return Ke.ONE;var r=Ve(),n=Ve(),i=e.convert(this),o=Je(t)-1;for(i.copyTo(r);0<=--o;)if(e.sqrTo(r,n),0<(t&1<<o))e.mulTo(n,i,r);else{var s=r;r=n,n=s}return e.revert(r)},Ke.prototype.chunkSize=function(t){return Math.floor(Math.LN2*this.DB/Math.log(t))},Ke.prototype.toRadix=function(t){if(null==t&&(t=10),0===this.signum()||2>t||36<t)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),n=Ze(r),i=Ve(),o=Ve(),s="";for(this.divRemTo(n,i,o);0<i.signum();)s=(r+o.intValue()).toString(t).substr(1)+s,i.divRemTo(n,i,o);return o.intValue().toString(t)+s},Ke.prototype.fromRadix=function(t,e){this.fromInt(0),null==e&&(e=10);for(var r,n=this.chunkSize(e),i=Math.pow(e,n),o=!1,s=0,f=0,h=0;h<t.length;++h)0>(r=We(t,h))?"-"==t.charAt(h)&&0===this.signum()&&(o=!0):(f=e*f+r,++s>=n&&(this.dMultiply(i),this.dAddOffset(f,0),s=0,f=0));0<s&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(f,0)),o&&Ke.ZERO.subTo(this,this)},Ke.prototype.fromNumber=function(t,r){if("number"!=typeof r){var n=e.randomBytes(1+(t>>3)),i=7&t;0<i?n[0]&=(1<<i)-1:n[0]=0,this.fromByteArray(n)}else if(2>t)this.fromInt(1);else for(this.fromNumber(t),this.testBit(t-1)||this.bitwiseTo(Ke.ONE.shiftLeft(t-1),er,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(r);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(Ke.ONE.shiftLeft(t-1),this)},Ke.prototype.bitwiseTo=function(t,e,r){var n,i,o=Math.min(t.t,this.t);for(n=0;n<o;++n)r[n]=e(this[n],t[n]);if(t.t<this.t){for(i=t.s&this.DM,n=o;n<this.t;++n)r[n]=e(this[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=o;n<t.t;++n)r[n]=e(i,t[n]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()},Ke.prototype.changeBit=function(t,e){var r=Ke.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r},Ke.prototype.addTo=function(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this[r]+t[r],e[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;r<this.t;)n+=this[r],e[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n+=t[r],e[r++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=0>n?-1:0,0<n?e[r++]=n:-1>n&&(e[r++]=this.DV+n),e.t=r,e.clamp()},Ke.prototype.dMultiply=function(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()},Ke.prototype.dAddOffset=function(t,e){if(0!==t){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}},Ke.prototype.multiplyLowerTo=function(t,e,r){var n,i=Math.min(this.t+t.t,e);for(r.s=0,r.t=i;0<i;)r[--i]=0;for(n=r.t-this.t;i<n;++i)r[i+this.t]=this.am(0,t[i],r,i,0,this.t);for(n=Math.min(t.t,e);i<n;++i)this.am(0,t[i],r,i,0,e-i);r.clamp()},Ke.prototype.multiplyUpperTo=function(t,e,r){--e;var n=r.t=this.t+t.t-e;for(r.s=0;0<=--n;)r[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)r[this.t+n-e]=this.am(e-n,t[n],r,0,0,this.t+n-e);r.clamp(),r.drShiftTo(1,r)},Ke.prototype.modInt=function(t){if(0>=t)return 0;var e=this.DV%t,r=0>this.s?t-1:0;if(0<this.t)if(0==e)r=this[0]%t;else for(var n=this.t-1;0<=n;--n)r=(e*r+this[n])%t;return r},Ke.prototype.millerRabin=function(t){var e=this.subtract(Ke.ONE),r=e.getLowestSetBit();if(0>=r)return!1;var n=e.shiftRight(r);(t=t+1>>1)>ur.length&&(t=ur.length);for(var i=Ve(),o=0;o<t;++o){i.fromInt(ur[Math.floor(Math.random()*ur.length)]);var s=i.modPow(n,this);if(0!=s.compareTo(Ke.ONE)&&0!=s.compareTo(e)){for(var f=1;f++<r&&0!=s.compareTo(e);)if(0===(s=s.modPowInt(2,this)).compareTo(Ke.ONE))return!1;if(0!=s.compareTo(e))return!1}}return!0},Ke.prototype.toString=function(t){if(0>this.s)return"-"+this.negate().toString(t);var e;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return this.toRadix(t);e=2}var r,n=(1<<e)-1,i=!1,o="",s=this.t,f=this.DB-s*this.DB%e;if(0<s--)for(f<this.DB&&0<(r=this[s]>>f)&&(i=!0,o=He(r));0<=s;)f<e?(r=(this[s]&(1<<f)-1)<<e-f,r|=this[--s]>>(f+=this.DB-e)):(r=this[s]>>(f-=e)&n,0>=f&&(f+=this.DB,--s)),0<r&&(i=!0),i&&(o+=He(r));return i?o:"0"},Ke.prototype.negate=function(){var t=Ve();return Ke.ZERO.subTo(this,t),t},Ke.prototype.abs=function(){return 0>this.s?this.negate():this},Ke.prototype.compareTo=function(t){var e=this.s-t.s;if(0!=e)return e;var r=this.t;if(0!=(e=r-t.t))return 0>this.s?-e:e;for(;0<=--r;)if(0!=(e=this[r]-t[r]))return e;return 0},Ke.prototype.bitLength=function(){return 0>=this.t?0:this.DB*(this.t-1)+Je(this[this.t-1]^this.s&this.DM)},Ke.prototype.mod=function(t){var e=Ve();return this.abs().divRemTo(t,null,e),0>this.s&&0<e.compareTo(Ke.ZERO)&&t.subTo(e,e),e},Ke.prototype.modPowInt=function(t,e){var r;return r=256>t||e.isEven()?new Xe(e):new Qe(e),this.exp(t,r)},Ke.prototype.clone=function(){var t=Ve();return this.copyTo(t),t},Ke.prototype.intValue=function(){if(0>this.s){if(1==this.t)return this[0]-this.DV;if(0===this.t)return-1}else{if(1==this.t)return this[0];if(0===this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},Ke.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},Ke.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},Ke.prototype.signum=function(){return 0>this.s?-1:0>=this.t||1==this.t&&0>=this[0]?0:1},Ke.prototype.toByteArray=function(){var t=this.t,e=[];e[0]=this.s;var r,n=this.DB-t*this.DB%8,i=0;if(0<t--)for(n<this.DB&&(r=this[t]>>n)!=(this.s&this.DM)>>n&&(e[i++]=r|this.s<<this.DB-n);0<=t;)8>n?(r=(this[t]&(1<<n)-1)<<8-n,r|=this[--t]>>(n+=this.DB-8)):(r=255&this[t]>>(n-=8),0>=n&&(n+=this.DB,--t)),0!=(128&r)&&(r|=-256),0==i&&(128&this.s)!=(128&r)&&++i,(0<i||r!=this.s)&&(e[i++]=r);return e},Ke.prototype.toBuffer=function(t){var e=Buffer.from(this.toByteArray());if(!0===t&&0===e[0])e=e.slice(1);else if(Ce.isNumber(t)){if(e.length>t){for(var r=0;r<e.length-t;r++)if(0!==e[r])return null;return e.slice(e.length-t)}if(e.length<t){var n=Buffer.alloc(t);return n.fill(0,0,t-e.length),e.copy(n,t-e.length),n}}return e},Ke.prototype.equals=function(t){return 0==this.compareTo(t)},Ke.prototype.min=function(t){return 0>this.compareTo(t)?this:t},Ke.prototype.max=function(t){return 0<this.compareTo(t)?this:t},Ke.prototype.and=function(t){var e=Ve();return this.bitwiseTo(t,tr,e),e},Ke.prototype.or=function(t){var e=Ve();return this.bitwiseTo(t,er,e),e},Ke.prototype.xor=function(t){var e=Ve();return this.bitwiseTo(t,rr,e),e},Ke.prototype.andNot=function(t){var e=Ve();return this.bitwiseTo(t,nr,e),e},Ke.prototype.not=function(){for(var t=Ve(),e=0;e<this.t;++e)t[e]=this.DM&~this[e];return t.t=this.t,t.s=~this.s,t},Ke.prototype.shiftLeft=function(t){var e=Ve();return 0>t?this.rShiftTo(-t,e):this.lShiftTo(t,e),e},Ke.prototype.shiftRight=function(t){var e=Ve();return 0>t?this.lShiftTo(-t,e):this.rShiftTo(t,e),e},Ke.prototype.getLowestSetBit=function(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+ir(this[t]);return 0>this.s?this.t*this.DB:-1},Ke.prototype.bitCount=function(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=or(this[r]^e);return t},Ke.prototype.testBit=function(t){var e=Math.floor(t/this.DB);return e>=this.t?0!=this.s:0!=(this[e]&1<<t%this.DB)},Ke.prototype.setBit=function(t){return this.changeBit(t,er)},Ke.prototype.clearBit=function(t){return this.changeBit(t,nr)},Ke.prototype.flipBit=function(t){return this.changeBit(t,rr)},Ke.prototype.add=function(t){var e=Ve();return this.addTo(t,e),e},Ke.prototype.subtract=function(t){var e=Ve();return this.subTo(t,e),e},Ke.prototype.multiply=function(t){var e=Ve();return this.multiplyTo(t,e),e},Ke.prototype.divide=function(t){var e=Ve();return this.divRemTo(t,e,null),e},Ke.prototype.remainder=function(t){var e=Ve();return this.divRemTo(t,null,e),e},Ke.prototype.divideAndRemainder=function(t){var e=Ve(),r=Ve();return this.divRemTo(t,e,r),[e,r]},Ke.prototype.modPow=function(t,e){var r,n,i=t.bitLength(),o=Ze(1);if(0>=i)return o;r=18>i?1:48>i?3:144>i?4:768>i?5:6,n=8>i?new Xe(e):e.isEven()?new hr(e):new Qe(e);var s=[],f=3,h=r-1,u=(1<<r)-1;if(s[1]=n.convert(this),1<r){var a=Ve();for(n.sqrTo(s[1],a);f<=u;)s[f]=Ve(),n.mulTo(a,s[f-2],s[f]),f+=2}var p,c,l=t.t-1,y=!0,m=Ve();for(i=Je(t[l])-1;0<=l;){for(i>=h?p=t[l]>>i-h&u:(p=(t[l]&(1<<i+1)-1)<<h-i,0<l&&(p|=t[l-1]>>this.DB+i-h)),f=r;0==(1&p);)p>>=1,--f;if(0>(i-=f)&&(i+=this.DB,--l),y)s[p].copyTo(o),y=!1;else{for(;1<f;)n.sqrTo(o,m),n.sqrTo(m,o),f-=2;0<f?n.sqrTo(o,m):(c=o,o=m,m=c),n.mulTo(m,s[p],o)}for(;0<=l&&0==(t[l]&1<<i);)n.sqrTo(o,m),c=o,o=m,m=c,0>--i&&(i=this.DB-1,--l)}return n.revert(o)},Ke.prototype.modInverse=function(t){var e=t.isEven();if(this.isEven()&&e||0===t.signum())return Ke.ZERO;for(var r=t.clone(),n=this.clone(),i=Ze(1),o=Ze(0),s=Ze(0),f=Ze(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),e?((!i.isEven()||!o.isEven())&&(i.addTo(this,i),o.subTo(t,o)),i.rShiftTo(1,i)):!o.isEven()&&o.subTo(t,o),o.rShiftTo(1,o);for(;n.isEven();)n.rShiftTo(1,n),e?((!s.isEven()||!f.isEven())&&(s.addTo(this,s),f.subTo(t,f)),s.rShiftTo(1,s)):!f.isEven()&&f.subTo(t,f),f.rShiftTo(1,f);0<=r.compareTo(n)?(r.subTo(n,r),e&&i.subTo(s,i),o.subTo(f,o)):(n.subTo(r,n),e&&s.subTo(i,s),f.subTo(o,f))}return 0!=n.compareTo(Ke.ONE)?Ke.ZERO:0<=f.compareTo(t)?f.subtract(t):0>f.signum()?(f.addTo(t,f),0>f.signum()?f.add(t):f):f},Ke.prototype.pow=function(t){return this.exp(t,new sr)},Ke.prototype.gcd=function(t){var e=0>this.s?this.negate():this.clone(),r=0>t.s?t.negate():t.clone();if(0>e.compareTo(r)){var n=e;e=r,r=n}var i=e.getLowestSetBit(),o=r.getLowestSetBit();if(0>o)return e;for(i<o&&(o=i),0<o&&(e.rShiftTo(o,e),r.rShiftTo(o,r));0<e.signum();)0<(i=e.getLowestSetBit())&&e.rShiftTo(i,e),0<(i=r.getLowestSetBit())&&r.rShiftTo(i,r),0<=e.compareTo(r)?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return 0<o&&r.lShiftTo(o,r),r},Ke.prototype.isProbablePrime=function(t){var e,r=this.abs();if(1==r.t&&r[0]<=ur[ur.length-1]){for(e=0;e<ur.length;++e)if(r[0]==ur[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<ur.length;){for(var n=ur[e],i=e+1;i<ur.length&&n<ar;)n*=ur[i++];for(n=r.modInt(n);e<i;)if(0==n%ur[e++])return!1}return r.millerRabin(t)},Ke.int2char=He,Ke.ZERO=Ze(0),Ke.ONE=Ze(1),Ke.prototype.square=function(){var t=Ve();return this.squareTo(t),t};var pr=Ke,cr=function(t){if(t>4294967295)throw new RangeError("requested too many random bytes");var e=Buffer.allocUnsafe(t);if(0<t)if(t>65536)for(var r=0;r<t;r+=65536)lr(e.slice(r,r+65536));else lr(e);return e};function lr(t){for(var e=0;e<t.length;e++)t[e]=Math.floor(256*Math.random())}var yr=o(function(t,e){var r=n.Buffer;function i(t,e){for(var r in t)e[r]=t[r]}function o(t,e,n){return r(t,e,n)}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?t.exports=n:(i(n,e),e.Buffer=o),i(r,o),o.from=function(t,e,n){if("number"==typeof t)throw new TypeError("Argument must not be a number");return r(t,e,n)},o.alloc=function(t,e,n){if("number"!=typeof t)throw new TypeError("Argument must be a number");var i=r(t);return void 0!==e?"string"==typeof n?i.fill(e,n):i.fill(e):i.fill(0),i},o.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return r(t)},o.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return n.SlowBuffer(t)}}),mr=(yr.Buffer,yr.Buffer),gr=function(t,e){for(var n,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"sha1",o=mr.alloc(0),s=0;o.length<e;)n=dr(s++),o=mr.concat([o,r(i).update(t).update(n).digest()]);return o.slice(0,e)};function dr(t){var e=mr.allocUnsafe(4);return e.writeUInt32BE(t,0),e}var vr=function(t,e){for(var r=t.length,n=-1;++n<r;)t[n]^=e[n];return t};function br(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"sha256",e=0;return"md5-96"===(t=t.toLowerCase())||"sha1-96"===t||"sha256-96"===t||"sha512-96"===t?(t=t.substr(0,-3),e=12):"md2"===t||"md5"===t?e=16:"sha1"===t?e=20:"sha256"===t?e=32:"sha384"===t?e=48:"sha512"===t&&(e=64),e}var Sr=function(){for(var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=e.data,i=void 0===n?"":n,o=e.mgf,s=void 0===o?"sha1":o,f=e.pad1,h=void 0===f?"":f,u=e.hash,a=void 0===u?"sha256":u,p=e.encryptedDataLength,c=void 0===p?256:p,l=r(a).update(h,"utf8").digest(),y=br(a),m=Buffer.alloc(c-i.length-2*y-2),g=cr(32),d=0;d<g.length;d++){for(t=g[d];0===t;)t=cr(1)[0];g[d]=t}var v=Buffer.concat([l,m,Buffer.from(String.fromCharCode(1)),i]),b=gr(g,c-y-1,s),S=vr(v,b),w=gr(S,y,s),B=vr(g,w),E=Buffer.concat([Buffer.from(String.fromCharCode(0)),B,S]);return E},wr={md2:Buffer.from("3020300c06082a864886f70d020205000410","hex"),md5:Buffer.from("3020300c06082a864886f70d020505000410","hex"),sha1:Buffer.from("3021300906052b0e03021a05000414","hex"),sha224:Buffer.from("302d300d06096086480165030402040500041c","hex"),sha256:Buffer.from("3031300d060960864801650304020105000420","hex"),sha384:Buffer.from("3041300d060960864801650304020205000430","hex"),sha512:Buffer.from("3051300d060960864801650304020305000440","hex"),ripemd160:Buffer.from("3021300906052b2403020105000414","hex"),rmd160:Buffer.from("3021300906052b2403020105000414","hex")},Br={ripemd160:"rmd160"},Er={isEncryption:!0,isSignature:!0};Er.makeScheme=function(r,n){function i(t,e){this.key=t,this.options=e}return i.prototype.maxMessageLength=function(){return this.options.encryptionSchemeOptions&&this.options.encryptionSchemeOptions.padding==t.RSA_NO_PADDING?this.key.encryptedDataLength:this.key.encryptedDataLength-11},i.prototype.encPad=function(r,n){var i;if(n=n||{},r.length>this.key.maxMessageLength)throw new Error("Message too long for RSA (n="+this.key.encryptedDataLength+", l="+r.length+")");if(this.options.encryptionSchemeOptions&&this.options.encryptionSchemeOptions.padding==t.RSA_NO_PADDING)return(i=Buffer.alloc(this.key.maxMessageLength-r.length)).fill(0),Buffer.concat([i,r]);if(1===n.type)return(i=Buffer.alloc(this.key.encryptedDataLength-r.length-1)).fill(255,0,i.length-1),i[0]=1,i[i.length-1]=0,Buffer.concat([i,r]);if(this.options&&this.options.encryptionSchemeOptions&&this.options.encryptionSchemeOptions.mgf){var o=this.options.encryptionSchemeOptions,s=o.mgf,f=o.hash;return Sr({data:r,mgf:s,hash:f,encryptedDataLength:this.encryptedDataLength})}(i=Buffer.alloc(this.key.encryptedDataLength-r.length))[0]=0,i[1]=2;for(var h,u=e.randomBytes(i.length-3),a=0;a<u.length;a++){for(h=u[a];0===h;)h=e.randomBytes(1)[0];i[a+2]=h}return i[i.length-1]=0,Buffer.concat([i,r])},i.prototype.yihuo=function(t,e){return t.split("").map(function(t,r){return t===e[r]?0:1}).join("")},i.prototype.hexToBin=function(t){for(var e=[{key:0,val:"0000"},{key:1,val:"0001"},{key:2,val:"0010"},{key:3,val:"0011"},{key:4,val:"0100"},{key:5,val:"0101"},{key:6,val:"0110"},{key:7,val:"0111"},{key:8,val:"1000"},{key:9,val:"1001"},{key:"a",val:"1010"},{key:"b",val:"1011"},{key:"c",val:"1100"},{key:"d",val:"1101"},{key:"e",val:"1110"},{key:"f",val:"1111"}],r="",n=0;n<t.length;n++)for(var i=0;i<e.length;i++)if(t.charAt(n)==e[i].key){r=r.concat(e[i].val);break}return r},i.prototype.binToHex=function(t){var e=[{key:0,val:"0000"},{key:1,val:"0001"},{key:2,val:"0010"},{key:3,val:"0011"},{key:4,val:"0100"},{key:5,val:"0101"},{key:6,val:"0110"},{key:7,val:"0111"},{key:8,val:"1000"},{key:9,val:"1001"},{key:"a",val:"1010"},{key:"b",val:"1011"},{key:"c",val:"1100"},{key:"d",val:"1101"},{key:"e",val:"1110"},{key:"f",val:"1111"}],r="",n=[];for(0!=t.length%4&&(t="0000".substring(0,4-t.length%4).concat(t));4<t.length;)n.push(t.substring(0,4)),t=t.substring(4);n.push(t);for(var i=0;i<n.length;i++)for(var o=0;o<e.length;o++)if(n[i]==e[o].val){r=r.concat(e[o].key);break}return r},i.prototype._mgf1=function(t,r){for(var n,i=[],o=Math.ceil(r/20),s=0;s<o;s++)n=this.unsignedLongBuffer(s),i.push(e.createHash("sha1").update(Buffer.concat([t,n]),"hex").digest());return i=Buffer.alloc(r,Buffer.concat(i))},i.prototype.unsignedLongBuffer=function(t){var e=h({type:"Buffer",data:[0,0,0,t]});return JSON.parse(e,function(t,e){return e&&"Buffer"===e.type?Buffer.from(e.data):e})},i.prototype.randomBytes=function(t){if(t>4294967295)throw new RangeError("requested too many random bytes");var e=Buffer.allocUnsafe(t);if(0<t)if(t>65536)for(var r=0;r<t;r+=65536)this.getRandomValues(e.slice(r,r+65536));else this.getRandomValues(e);return e},i.prototype.getRandomValues=function(t){for(var e=0;e<t.length;e++)t[e]=Math.floor(256*Math.random())},i.prototype.encUnPad=function(e,r){r=r||{};var n=0;if(this.options.encryptionSchemeOptions&&this.options.encryptionSchemeOptions.padding==t.RSA_NO_PADDING)return"function"==typeof e.lastIndexOf?e.slice(e.lastIndexOf("\0")+1,e.length):e.slice(String.prototype.lastIndexOf.call(e,"\0")+1,e.length);if(4>e.length)return null;if(1===r.type){if(0!==e[0]&&1!==e[1])return null;for(n=3;0!==e[n];)if(255!=e[n]||++n>=e.length)return null}else{if(0!==e[0]&&2!==e[1])return null;for(n=3;0!==e[n];)if(++n>=e.length)return null}return e.slice(n+1,e.length)},i.prototype.sign=function(t){var r=this.options.signingSchemeOptions.hash||"sha256";if("browser"===this.options.environment){r=Br[r]||r;var n=e.createHash(r);n.update(t);var i=this.pkcs1pad(n.digest(),r);return this.key.$doPrivate(new pr(i)).toBuffer(this.key.encryptedDataLength)}var o=e.createSign("RSA-"+r.toUpperCase());return o.update(t),o.sign(this.options.rsaUtils.exportKey("private"))},i.prototype.verify=function(r,n,i){if(this.options.encryptionSchemeOptions&&this.options.encryptionSchemeOptions.padding==t.RSA_NO_PADDING)return!1;var o=this.options.signingSchemeOptions.hash||"sha256";if("browser"===this.options.environment){o=Br[o]||o,i&&(n=Buffer.from(n,i));var s=e.createHash(o);s.update(r);var f=this.pkcs1pad(s.digest(),o);return this.key.$doPublic(new pr(n)).toBuffer().toString("hex")==f.toString("hex")}var h=e.createVerify("RSA-"+o.toUpperCase());return h.update(r),h.verify(this.options.rsaUtils.exportKey("public"),n,i)},i.prototype.pkcs0pad=function(t){var e=Buffer.alloc(this.key.maxMessageLength-t.length);return e.fill(0),Buffer.concat([e,t])},i.prototype.pkcs0unpad=function(t){return"function"==typeof t.lastIndexOf?t.slice(t.lastIndexOf("\0")+1,t.length):t.slice(String.prototype.lastIndexOf.call(t,"\0")+1,t.length)},i.prototype.pkcs1pad=function(t,e){var r=wr[e];if(!r)throw Error("Unsupported hash algorithm");var n=Buffer.concat([r,t]);if(n.length+10>this.key.encryptedDataLength)throw Error("Key is too short for signing algorithm ("+e+")");var i=Buffer.alloc(this.key.encryptedDataLength-n.length-1);return i.fill(255,0,i.length-1),i[0]=1,i[i.length-1]=0,Buffer.concat([i,n])},new i(r,n)};var Tr=o(function(t){t.exports={isEncryption:!0,isSignature:!1},t.exports.digestLength={md4:16,md5:16,ripemd160:20,rmd160:20,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64};t.exports.eme_oaep_mgf1=function(r,n,i){i=i||"sha1";for(var o,s=t.exports.digestLength[i],f=Math.ceil(n/s),h=Buffer.alloc(s*f),u=Buffer.alloc(4),a=0;a<f;++a)(o=e.createHash(i)).update(r),u.writeUInt32BE(a,0),o.update(u),o.digest().copy(h,a*s);return h.slice(0,n)},t.exports.makeScheme=function(r,n){function i(t,e){this.key=t,this.options=e}return i.prototype.maxMessageLength=function(){return this.key.encryptedDataLength-2*t.exports.digestLength[this.options.encryptionSchemeOptions.hash||"sha1"]-2},i.prototype.encPad=function(r){var n=this.options.encryptionSchemeOptions.hash||"sha1",i=this.options.encryptionSchemeOptions.mgf||t.exports.eme_oaep_mgf1,o=this.options.encryptionSchemeOptions.label||Buffer.alloc(0),s=this.key.encryptedDataLength,f=t.exports.digestLength[n];if(r.length>s-2*f-2)throw new Error("Message is too long to encode into an encoded message with a length of "+s+" bytes, increaseemLen to fix this error (minimum value for given parameters and options: "+(s-2*f-2)+")");var h=e.createHash(n);h.update(o),h=h.digest();var u=Buffer.alloc(s-r.length-2*f-1);u.fill(0),u[u.length-1]=1;for(var a=Buffer.concat([h,u,r]),p=e.randomBytes(f),c=i(p,a.length,n),l=0;l<a.length;l++)a[l]^=c[l];for(c=i(a,f,n),l=0;l<p.length;l++)p[l]^=c[l];var y=Buffer.alloc(1+p.length+a.length);return y[0]=0,p.copy(y,1),a.copy(y,1+p.length),y},i.prototype.encUnPad=function(r){var n=this.options.encryptionSchemeOptions.hash||"sha1",i=this.options.encryptionSchemeOptions.mgf||t.exports.eme_oaep_mgf1,o=this.options.encryptionSchemeOptions.label||Buffer.alloc(0),s=t.exports.digestLength[n];if(r.length<2*s+2)throw new Error("Error decoding message, the supplied message is not long enough to be a valid OAEP encoded message");for(var f=r.slice(1,s+1),h=r.slice(1+s),u=i(h,s,n),a=0;a<f.length;a++)f[a]^=u[a];for(u=i(f,h.length,n),a=0;a<h.length;a++)h[a]^=u[a];var p=e.createHash(n);if(p.update(o),p=p.digest(),h.slice(0,s).toString("hex")!=p.toString("hex"))throw new Error("Error decoding message, the lHash calculated from the label provided and the lHash in the encrypted data do not match.");for(a=s;0===h[a++]&&a<h.length;);if(1!=h[a-1])throw new Error("Error decoding message, there is no padding message separator byte");return h.slice(a)},new i(r,n)}}),_r=(Tr.isEncryption,Tr.isSignature,Tr.digestLength,Tr.eme_oaep_mgf1,Tr.makeScheme,{isEncryption:!1,isSignature:!0});_r.makeScheme=function(t,r){function n(t,e){this.key=t,this.options=e}var i=kr.pkcs1_oaep;return n.prototype.sign=function(t){var r=e.createHash(this.options.signingSchemeOptions.hash||"sha1");r.update(t);var n=this.emsa_pss_encode(r.digest(),this.key.keySize-1);return this.key.$doPrivate(new pr(n)).toBuffer(this.key.encryptedDataLength)},n.prototype.verify=function(t,r,n){n&&(r=Buffer.from(r,n)),r=new pr(r);var i=Math.ceil((this.key.keySize-1)/8),o=this.key.$doPublic(r).toBuffer(i),s=e.createHash(this.options.signingSchemeOptions.hash||"sha1");return s.update(t),this.emsa_pss_verify(s.digest(),o,this.key.keySize-1)},n.prototype.emsa_pss_encode=function(t,r){var n=this.options.signingSchemeOptions.hash||"sha1",o=this.options.signingSchemeOptions.mgf||i.eme_oaep_mgf1,s=this.options.signingSchemeOptions.saltLength||20,f=i.digestLength[n],h=Math.ceil(r/8);if(h<f+s+2)throw new Error("Output length passed to emBits("+r+") is too small for the options specified("+n+", "+s+"). To fix this issue increase the value of emBits. (minimum size: "+(8*f+8*s+9)+")");var u=e.randomBytes(s),a=Buffer.alloc(8+f+s);a.fill(0,0,8),t.copy(a,8),u.copy(a,8+t.length);var p=e.createHash(n);p.update(a),p=p.digest();var c=Buffer.alloc(h-u.length-f-2);c.fill(0);var l=Buffer.alloc(c.length+1+u.length);c.copy(l),l[c.length]=1,u.copy(l,c.length+1);for(var y=o(p,l.length,n),m=Buffer.alloc(l.length),g=0;g<y.length;g++)m[g]=l[g]^y[g];var d=8*h-r;m[0]&=255^255>>8-d<<8-d;var v=Buffer.alloc(m.length+p.length+1);return m.copy(v,0),p.copy(v,m.length),v[v.length-1]=188,v},n.prototype.emsa_pss_verify=function(t,r,n){var o=this.options.signingSchemeOptions.hash||"sha1",s=this.options.signingSchemeOptions.mgf||i.eme_oaep_mgf1,f=this.options.signingSchemeOptions.saltLength||20,h=i.digestLength[o],u=Math.ceil(n/8);if(u<h+f+2||188!=r[r.length-1])return!1;var a=Buffer.alloc(u-h-1);r.copy(a,0,0,u-h-1);for(var p=0,c=0,l=8*u-n;c<l;c++)p|=1<<7-c;if(0!=(a[0]&p))return!1;var y=r.slice(u-h-1,u-1),m=s(y,a.length,o);for(c=0;c<a.length;c++)a[c]^=m[c];for(p=255^255>>8-(l=8*u-n)<<8-l,a[0]&=p,c=0;0===a[c]&&c<a.length;c++);if(1!=a[c])return!1;var g=a.slice(a.length-f),d=Buffer.alloc(8+h+f);d.fill(0,0,8),t.copy(d,8),g.copy(d,8+t.length);var v=e.createHash(o);return v.update(d),v=v.digest(),y.toString("hex")===v.toString("hex")},new n(t,r)};var Or,kr=o(function(t){t.exports={pkcs1:Er,pkcs1_oaep:Tr,pss:_r,isEncryption:function(e){return t.exports[e]&&t.exports[e].isEncryption},isSignature:function(e){return t.exports[e]&&t.exports[e].isSignature}}}),xr=(kr.pkcs1,kr.pkcs1_oaep,kr.pss,kr.isEncryption,kr.isSignature,function(t,e){return function(t,e){var r=kr.pkcs1.makeScheme(t,e);return{encrypt:function(e,n){var i,o;return n?(i=new pr(r.encPad(e,{type:1})),o=t.$doPrivate(i)):(i=new pr(t.encryptionScheme.encPad(e)),o=t.$doPublic(i)),o.toBuffer(t.encryptedDataLength)},decrypt:function(e,n){var i,o=new pr(e);return n?(i=t.$doPublic(o),r.encUnPad(i.toBuffer(t.encryptedDataLength),{type:1})):(i=t.$doPrivate(o),t.encryptionScheme.encUnPad(i.toBuffer(t.encryptedDataLength)))}}}(t,e)}),Pr=Ue._,Ir={BigInteger:pr,Key:function(){function t(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}return t.prototype.setOptions=function(t){var e=kr[t.signingScheme],r=kr[t.encryptionScheme];e===r?this.signingScheme=this.encryptionScheme=r.makeScheme(this,t):(this.encryptionScheme=r.makeScheme(this,t),this.signingScheme=e.makeScheme(this,t)),this.encryptEngine=xr(this,t)},t.prototype.generate=function(t,e){var r=t>>1;this.e=K(e,16);for(var n=new pr(e,16);;){for(;this.p=new pr(t-r,1),0!==this.p.subtract(pr.ONE).gcd(n).compareTo(pr.ONE)||!this.p.isProbablePrime(10););for(;this.q=new pr(r,1),0!==this.q.subtract(pr.ONE).gcd(n).compareTo(pr.ONE)||!this.q.isProbablePrime(10););if(0>=this.p.compareTo(this.q)){var i=this.p;this.p=this.q,this.q=i}var o=this.p.subtract(pr.ONE),s=this.q.subtract(pr.ONE),f=o.multiply(s);if(0===f.gcd(n).compareTo(pr.ONE)){if(this.n=this.p.multiply(this.q),this.n.bitLength()<t)continue;this.d=n.modInverse(f),this.dmp1=this.d.mod(o),this.dmq1=this.d.mod(s),this.coeff=this.q.modInverse(this.p);break}}this.$$recalculateCache()},t.prototype.setPrivate=function(t,e,r,n,i,o,s,f){if(!(t&&e&&r&&0<t.length&&(Pr.isNumber(e)||0<e.length)&&0<r.length))throw Error("Invalid RSA private key");this.n=new pr(t),this.e=Pr.isNumber(e)?e:Ue.get32IntFromBuffer(e,0),this.d=new pr(r),n&&i&&o&&s&&f&&(this.p=new pr(n),this.q=new pr(i),this.dmp1=new pr(o),this.dmq1=new pr(s),this.coeff=new pr(f)),this.$$recalculateCache()},t.prototype.setPublic=function(t,e){if(!(t&&e&&0<t.length&&(Pr.isNumber(e)||0<e.length)))throw Error("Invalid RSA public key");this.n=new pr(t),this.e=Pr.isNumber(e)?e:Ue.get32IntFromBuffer(e,0),this.$$recalculateCache()},t.prototype.$doPrivate=function(t){if(this.p||this.q)return t.modPow(this.d,this.n);for(var e=t.mod(this.p).modPow(this.dmp1,this.p),r=t.mod(this.q).modPow(this.dmq1,this.q);0>e.compareTo(r);)e=e.add(this.p);return e.subtract(r).multiply(this.coeff).mod(this.p).multiply(this.q).add(r)},t.prototype.$doPublic=function(t){return t.modPowInt(this.e,this.n)},t.prototype.encrypt=function(t,e){var r=[],n=[],i=t.length,o=Math.ceil(i/this.maxMessageLength)||1,s=Math.ceil(i/o||1);if(1==o)r.push(t);else for(var f=0;f<o;f++)r.push(t.slice(f*s,(f+1)*s));for(var h=0;h<r.length;h++)n.push(this.encryptEngine.encrypt(r[h],e));return Buffer.concat(n)},t.prototype.decrypt=function(t,e){if(0<t.length%this.encryptedDataLength)throw Error("Incorrect data or key");for(var r=[],n=0,i=0,o=t.length/this.encryptedDataLength,s=0;s<o;s++)i=(n=s*this.encryptedDataLength)+this.encryptedDataLength,r.push(this.encryptEngine.decrypt(t.slice(n,Math.min(i,t.length)),e));return Buffer.concat(r)},t.prototype.sign=function(){return this.signingScheme.sign.apply(this.signingScheme,arguments)},t.prototype.verify=function(){return this.signingScheme.verify.apply(this.signingScheme,arguments)},t.prototype.isPrivate=function(){return this.n&&this.e&&this.d||!1},t.prototype.isPublic=function(t){return this.n&&this.e&&!(t&&this.d)||!1},P(t.prototype,"keySize",{get:function(){return this.cache.keyBitLength}}),P(t.prototype,"encryptedDataLength",{get:function(){return this.cache.keyByteLength}}),P(t.prototype,"maxMessageLength",{get:function(){return this.encryptionScheme.maxMessageLength()}}),t.prototype.$$recalculateCache=function(){this.cache=this.cache||{},this.cache.keyBitLength=this.n.bitLength(),this.cache.keyByteLength=this.cache.keyBitLength+6>>3},t}()},Dr={newInvalidAsn1Error:function(t){var e=new Error;return e.name="InvalidAsn1Error",e.message=t||"",e}},Lr={EOC:0,Boolean:1,Integer:2,BitString:3,OctetString:4,Null:5,OID:6,ObjectDescriptor:7,External:8,Real:9,Enumeration:10,PDV:11,Utf8String:12,RelativeOID:13,Sequence:16,Set:17,NumericString:18,PrintableString:19,T61String:20,VideotexString:21,IA5String:22,UTCTime:23,GeneralizedTime:24,GraphicString:25,VisibleString:26,GeneralString:28,UniversalString:29,CharacterString:30,BMPString:31,Constructor:32,Context:128},Ar=n.Buffer,Nr={};for(Or in n)n.hasOwnProperty(Or)&&"SlowBuffer"!==Or&&"Buffer"!==Or&&(Nr[Or]=n[Or]);var Rr=Nr.Buffer={};for(Or in Ar)Ar.hasOwnProperty(Or)&&"allocUnsafe"!==Or&&"allocUnsafeSlow"!==Or&&(Rr[Or]=Ar[Or]);if(Nr.Buffer.prototype=Ar.prototype,Rr.from&&Rr.from!==Uint8Array.from||(Rr.from=function(t,e,r){if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type '+typeof t);if(t&&void 0===t.length)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);return Ar(t,e,r)}),Rr.alloc||(Rr.alloc=function(t,e,r){if("number"!=typeof t)throw new TypeError('The "size" argument must be of type number. Received type '+typeof t);if(t<0||t>=2*(1<<30))throw new RangeError('The value "'+t+'" is invalid for option "size"');var n=Ar(t);return e&&0!==e.length?"string"==typeof r?n.fill(e,r):n.fill(e):n.fill(0),n}),!Nr.kStringMaxLength)try{Nr.kStringMaxLength=process.binding("buffer").kStringMaxLength}catch(t){}Nr.constants||(Nr.constants={MAX_LENGTH:Nr.kMaxLength},Nr.kStringMaxLength&&(Nr.constants.MAX_STRING_LENGTH=Nr.kStringMaxLength));var qr=Nr,Mr=qr.Buffer,$r=Dr.newInvalidAsn1Error;function jr(t){if(!t||!Mr.isBuffer(t))throw new TypeError("data must be a node Buffer");this._buf=t,this._size=t.length,this._len=0,this._offset=0}Object.defineProperty(jr.prototype,"length",{enumerable:!0,get:function(){return this._len}}),Object.defineProperty(jr.prototype,"offset",{enumerable:!0,get:function(){return this._offset}}),Object.defineProperty(jr.prototype,"remain",{get:function(){return this._size-this._offset}}),Object.defineProperty(jr.prototype,"buffer",{get:function(){return this._buf.slice(this._offset)}}),jr.prototype.readByte=function(t){if(this._size-this._offset<1)return null;var e=255&this._buf[this._offset];return t||(this._offset+=1),e},jr.prototype.peek=function(){return this.readByte(!0)},jr.prototype.readLength=function(t){if(void 0===t&&(t=this._offset),t>=this._size)return null;var e=255&this._buf[t++];if(null===e)return null;if(128==(128&e)){if(0===(e&=127))throw $r("Indefinite length not supported");if(e>4)throw $r("encoding too long");if(this._size-t<e)return null;this._len=0;for(var r=0;r<e;r++)this._len=(this._len<<8)+(255&this._buf[t++])}else this._len=e;return t},jr.prototype.readSequence=function(t){var e=this.peek();if(null===e)return null;if(void 0!==t&&t!==e)throw $r("Expected 0x"+t.toString(16)+": got 0x"+e.toString(16));var r=this.readLength(this._offset+1);return null===r?null:(this._offset=r,e)},jr.prototype.readInt=function(){return this._readTag(Lr.Integer)},jr.prototype.readBoolean=function(){return 0!==this._readTag(Lr.Boolean)},jr.prototype.readEnumeration=function(){return this._readTag(Lr.Enumeration)},jr.prototype.readString=function(t,e){t||(t=Lr.OctetString);var r=this.peek();if(null===r)return null;if(r!==t)throw $r("Expected 0x"+t.toString(16)+": got 0x"+r.toString(16));var n=this.readLength(this._offset+1);if(null===n)return null;if(this.length>this._size-n)return null;if(this._offset=n,0===this.length)return e?Mr.alloc(0):"";var i=this._buf.slice(this._offset,this._offset+this.length);return this._offset+=this.length,e?i:i.toString("utf8")},jr.prototype.readOID=function(t){t||(t=Lr.OID);var e=this.readString(t,!0);if(null===e)return null;for(var r=[],n=0,i=0;i<e.length;i++){var o=255&e[i];n<<=7,n+=127&o,0==(128&o)&&(r.push(n),n=0)}return n=r.shift(),r.unshift(n%40),r.unshift(n/40>>0),r.join(".")},jr.prototype._readTag=function(t){i.ok(void 0!==t);var e=this.peek();if(null===e)return null;if(e!==t)throw $r("Expected 0x"+t.toString(16)+": got 0x"+e.toString(16));var r=this.readLength(this._offset+1);if(null===r)return null;if(this.length>4)throw $r("Integer too long: "+this.length);if(this.length>this._size-r)return null;this._offset=r;for(var n=this._buf[this._offset],o=0,s=0;s<this.length;s++)o<<=8,o|=255&this._buf[this._offset++];return 128==(128&n)&&4!==s&&(o-=1<<8*s),o>>0};var Ur=jr,Cr=qr.Buffer,Kr=Dr.newInvalidAsn1Error,Vr={size:1024,growthFactor:8};function Fr(t){var e,r;e=Vr,r=t||{},i.ok(e),i.equal(typeof e,"object"),i.ok(r),i.equal(typeof r,"object"),Object.getOwnPropertyNames(e).forEach(function(t){if(!r[t]){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,n)}}),t=r,this._buf=Cr.alloc(t.size||1024),this._size=this._buf.length,this._offset=0,this._options=t,this._seq=[]}Object.defineProperty(Fr.prototype,"buffer",{get:function(){if(this._seq.length)throw Kr(this._seq.length+" unended sequence(s)");return this._buf.slice(0,this._offset)}}),Fr.prototype.writeByte=function(t){if("number"!=typeof t)throw new TypeError("argument must be a Number");this._ensure(1),this._buf[this._offset++]=t},Fr.prototype.writeInt=function(t,e){if("number"!=typeof t)throw new TypeError("argument must be a Number");"number"!=typeof e&&(e=Lr.Integer);for(var r=4;(0==(4286578688&t)||-8388608==(4286578688&t))&&r>1;)r--,t<<=8;if(r>4)throw Kr("BER ints cannot be > 0xffffffff");for(this._ensure(2+r),this._buf[this._offset++]=e,this._buf[this._offset++]=r;r-- >0;)this._buf[this._offset++]=(4278190080&t)>>>24,t<<=8},Fr.prototype.writeNull=function(){this.writeByte(Lr.Null),this.writeByte(0)},Fr.prototype.writeEnumeration=function(t,e){if("number"!=typeof t)throw new TypeError("argument must be a Number");return"number"!=typeof e&&(e=Lr.Enumeration),this.writeInt(t,e)},Fr.prototype.writeBoolean=function(t,e){if("boolean"!=typeof t)throw new TypeError("argument must be a Boolean");"number"!=typeof e&&(e=Lr.Boolean),this._ensure(3),this._buf[this._offset++]=e,this._buf[this._offset++]=1,this._buf[this._offset++]=t?255:0},Fr.prototype.writeString=function(t,e){if("string"!=typeof t)throw new TypeError("argument must be a string (was: "+typeof t+")");"number"!=typeof e&&(e=Lr.OctetString);var r=Cr.byteLength(t);this.writeByte(e),this.writeLength(r),r&&(this._ensure(r),this._buf.write(t,this._offset),this._offset+=r)},Fr.prototype.writeBuffer=function(t,e){if("number"!=typeof e)throw new TypeError("tag must be a number");if(!Cr.isBuffer(t))throw new TypeError("argument must be a buffer");this.writeByte(e),this.writeLength(t.length),this._ensure(t.length),t.copy(this._buf,this._offset,0,t.length),this._offset+=t.length},Fr.prototype.writeStringArray=function(t){if(!t instanceof Array)throw new TypeError("argument must be an Array[String]");var e=this;t.forEach(function(t){e.writeString(t)})},Fr.prototype.writeOID=function(t,e){if("string"!=typeof t)throw new TypeError("argument must be a string");if("number"!=typeof e&&(e=Lr.OID),!/^([0-9]+\.){3,}[0-9]+$/.test(t))throw new Error("argument is not a valid OID string");var r=t.split("."),n=[];n.push(40*parseInt(r[0],10)+parseInt(r[1],10)),r.slice(2).forEach(function(t){!function(t,e){e<128?t.push(e):e<16384?(t.push(e>>>7|128),t.push(127&e)):e<2097152?(t.push(e>>>14|128),t.push(255&(e>>>7|128)),t.push(127&e)):e<268435456?(t.push(e>>>21|128),t.push(255&(e>>>14|128)),t.push(255&(e>>>7|128)),t.push(127&e)):(t.push(255&(e>>>28|128)),t.push(255&(e>>>21|128)),t.push(255&(e>>>14|128)),t.push(255&(e>>>7|128)),t.push(127&e))}(n,parseInt(t,10))});var i=this;this._ensure(2+n.length),this.writeByte(e),this.writeLength(n.length),n.forEach(function(t){i.writeByte(t)})},Fr.prototype.writeLength=function(t){if("number"!=typeof t)throw new TypeError("argument must be a Number");if(this._ensure(4),t<=127)this._buf[this._offset++]=t;else if(t<=255)this._buf[this._offset++]=129,this._buf[this._offset++]=t;else if(t<=65535)this._buf[this._offset++]=130,this._buf[this._offset++]=t>>8,this._buf[this._offset++]=t;else{if(!(t<=16777215))throw Kr("Length too long (> 4 bytes)");this._buf[this._offset++]=131,this._buf[this._offset++]=t>>16,this._buf[this._offset++]=t>>8,this._buf[this._offset++]=t}},Fr.prototype.startSequence=function(t){"number"!=typeof t&&(t=Lr.Sequence|Lr.Constructor),this.writeByte(t),this._seq.push(this._offset),this._ensure(3),this._offset+=3},Fr.prototype.endSequence=function(){var t=this._seq.pop(),e=t+3,r=this._offset-e;if(r<=127)this._shift(e,r,-2),this._buf[t]=r;else if(r<=255)this._shift(e,r,-1),this._buf[t]=129,this._buf[t+1]=r;else if(r<=65535)this._buf[t]=130,this._buf[t+1]=r>>8,this._buf[t+2]=r;else{if(!(r<=16777215))throw Kr("Sequence too long");this._shift(e,r,1),this._buf[t]=131,this._buf[t+1]=r>>16,this._buf[t+2]=r>>8,this._buf[t+3]=r}},Fr.prototype._shift=function(t,e,r){i.ok(void 0!==t),i.ok(void 0!==e),i.ok(r),this._buf.copy(this._buf,t+r,t,t+e),this._offset+=r},Fr.prototype._ensure=function(t){if(i.ok(t),this._size-this._offset<t){var e=this._size*this._options.growthFactor;e-this._offset<t&&(e+=t);var r=Cr.alloc(e);this._buf.copy(r,0,0,this._offset),this._buf=r,this._size=e}};var zr=Fr,Gr=o(function(t){for(var e in t.exports={Reader:Ur,Writer:zr},Lr)Lr.hasOwnProperty(e)&&(t.exports[e]=Lr[e]);for(var r in Dr)Dr.hasOwnProperty(r)&&(t.exports[r]=Dr[r])}),Yr=(Gr.Reader,Gr.Writer,{Ber:Gr,BerReader:Gr.Reader,BerWriter:Gr.Writer}),Hr=o(function(t){var e=Yr.Ber,r=Ue._,n=Ue;t.exports={privateExport:function(t,r){r=r||{};var i=t.n.toBuffer(),o=t.d.toBuffer(),s=t.p.toBuffer(),f=t.q.toBuffer(),h=t.dmp1.toBuffer(),u=t.dmq1.toBuffer(),a=t.coeff.toBuffer(),p=i.length+o.length+s.length+f.length+h.length+u.length+a.length+512,c=new e.Writer({size:p});return c.startSequence(),c.writeInt(0),c.writeBuffer(i,2),c.writeInt(t.e),c.writeBuffer(o,2),c.writeBuffer(s,2),c.writeBuffer(f,2),c.writeBuffer(h,2),c.writeBuffer(u,2),c.writeBuffer(a,2),c.endSequence(),"der"===r.type?c.buffer:"-----BEGIN RSA PRIVATE KEY-----\n"+n.linebrk(c.buffer.toString("base64"),64)+"\n-----END RSA PRIVATE KEY-----"},privateImport:function(t,i,o){var s;if("der"!==(o=o||{}).type){if(Buffer.isBuffer(i)&&(i=i.toString("utf8")),!r.isString(i))throw Error("Unsupported key format");var f=n.trimSurroundingText(i,"-----BEGIN RSA PRIVATE KEY-----","-----END RSA PRIVATE KEY-----").replace(/\s+|\n\r|\n|\r$/gm,"");s=Buffer.from(f,"base64")}else{if(!Buffer.isBuffer(i))throw Error("Unsupported key format");s=i}var h=new e.Reader(s);h.readSequence(),h.readString(2,!0),t.setPrivate(h.readString(2,!0),h.readString(2,!0),h.readString(2,!0),h.readString(2,!0),h.readString(2,!0),h.readString(2,!0),h.readString(2,!0),h.readString(2,!0))},publicExport:function(t,r){r=r||{};var i=t.n.toBuffer(),o=i.length+512,s=new e.Writer({size:o});return s.startSequence(),s.writeBuffer(i,2),s.writeInt(t.e),s.endSequence(),"der"===r.type?s.buffer:"-----BEGIN RSA PUBLIC KEY-----\n"+n.linebrk(s.buffer.toString("base64"),64)+"\n-----END RSA PUBLIC KEY-----"},publicImport:function(t,i,o){var s;if("der"!==(o=o||{}).type){if(Buffer.isBuffer(i)&&(i=i.toString("utf8")),r.isString(i)){var f=n.trimSurroundingText(i,"-----BEGIN RSA PUBLIC KEY-----","-----END RSA PUBLIC KEY-----").replace(/\s+|\n\r|\n|\r$/gm,"");s=Buffer.from(f,"base64")}}else{if(!Buffer.isBuffer(i))throw Error("Unsupported key format");s=i}var h=new e.Reader(s);h.readSequence(),t.setPublic(h.readString(2,!0),h.readString(2,!0))},autoImport:function(e,r){return/^[\S\s]*-----BEGIN RSA PRIVATE KEY-----\s*(?=(([A-Za-z0-9+\/=]+\s*)+))\1-----END RSA PRIVATE KEY-----[\S\s]*$/g.test(r)?(t.exports.privateImport(e,r),!0):!!/^[\S\s]*-----BEGIN RSA PUBLIC KEY-----\s*(?=(([A-Za-z0-9+\/=]+\s*)+))\1-----END RSA PUBLIC KEY-----[\S\s]*$/g.test(r)&&(t.exports.publicImport(e,r),!0)}}}),Wr=(Hr.privateExport,Hr.privateImport,Hr.publicExport,Hr.publicImport,Hr.autoImport,o(function(t){var e=Yr.Ber,r=Ue._,n=Ue;t.exports={privateExport:function(t,r){r=r||{};var i=t.n.toBuffer(),o=t.d.toBuffer(),s=t.p.toBuffer(),f=t.q.toBuffer(),h=t.dmp1.toBuffer(),u=t.dmq1.toBuffer(),a=t.coeff.toBuffer(),p=i.length+o.length+s.length+f.length+h.length+u.length+a.length+512,c=new e.Writer({size:p});c.startSequence(),c.writeInt(0),c.writeBuffer(i,2),c.writeInt(t.e),c.writeBuffer(o,2),c.writeBuffer(s,2),c.writeBuffer(f,2),c.writeBuffer(h,2),c.writeBuffer(u,2),c.writeBuffer(a,2),c.endSequence();var l=new e.Writer({size:p});return l.startSequence(),l.writeInt(0),l.startSequence(),l.writeOID("1.2.840.113549.1.1.1"),l.writeNull(),l.endSequence(),l.writeBuffer(c.buffer,4),l.endSequence(),"der"===r.type?l.buffer:"-----BEGIN PRIVATE KEY-----\n"+n.linebrk(l.buffer.toString("base64"),64)+"\n-----END PRIVATE KEY-----"},privateImport:function(t,i,o){var s;if("der"!==(o=o||{}).type){if(Buffer.isBuffer(i)&&(i=i.toString("utf8")),!r.isString(i))throw Error("Unsupported key format");var f=n.trimSurroundingText(i,"-----BEGIN PRIVATE KEY-----","-----END PRIVATE KEY-----").replace("-----END PRIVATE KEY-----","").replace(/\s+|\n\r|\n|\r$/gm,"");s=Buffer.from(f,"base64")}else{if(!Buffer.isBuffer(i))throw Error("Unsupported key format");s=i}var h=new e.Reader(s);if(h.readSequence(),h.readInt(0),"1.2.840.113549.1.1.1"!==new e.Reader(h.readString(48,!0)).readOID(6,!0))throw Error("Invalid Public key format");var u=new e.Reader(h.readString(4,!0));u.readSequence(),u.readString(2,!0),t.setPrivate(u.readString(2,!0),u.readString(2,!0),u.readString(2,!0),u.readString(2,!0),u.readString(2,!0),u.readString(2,!0),u.readString(2,!0),u.readString(2,!0))},publicExport:function(t,r){r=r||{};var i=t.n.toBuffer(),o=i.length+512,s=new e.Writer({size:o});s.writeByte(0),s.startSequence(),s.writeBuffer(i,2),s.writeInt(t.e),s.endSequence();var f=new e.Writer({size:o});return f.startSequence(),f.startSequence(),f.writeOID("1.2.840.113549.1.1.1"),f.writeNull(),f.endSequence(),f.writeBuffer(s.buffer,3),f.endSequence(),"der"===r.type?f.buffer:"-----BEGIN PUBLIC KEY-----\n"+n.linebrk(f.buffer.toString("base64"),64)+"\n-----END PUBLIC KEY-----"},publicImport:function(t,i,o){var s;if("der"!==(o=o||{}).type){if(Buffer.isBuffer(i)&&(i=i.toString("utf8")),r.isString(i)){var f=n.trimSurroundingText(i,"-----BEGIN PUBLIC KEY-----","-----END PUBLIC KEY-----").replace(/\s+|\n\r|\n|\r$/gm,"");s=Buffer.from(f,"base64")}}else{if(!Buffer.isBuffer(i))throw Error("Unsupported key format");s=i}var h=new e.Reader(s);if(h.readSequence(),"1.2.840.113549.1.1.1"!==new e.Reader(h.readString(48,!0)).readOID(6,!0))throw Error("Invalid Public key format");var u=new e.Reader(h.readString(3,!0));u.readByte(),u.readSequence(),t.setPublic(u.readString(2,!0),u.readString(2,!0))},autoImport:function(e,r){return/^[\S\s]*-----BEGIN PRIVATE KEY-----\s*(?=(([A-Za-z0-9+\/=]+\s*)+))\1-----END PRIVATE KEY-----[\S\s]*$/g.test(r)?(t.exports.privateImport(e,r),!0):!!/^[\S\s]*-----BEGIN PUBLIC KEY-----\s*(?=(([A-Za-z0-9+\/=]+\s*)+))\1-----END PUBLIC KEY-----[\S\s]*$/g.test(r)&&(t.exports.publicImport(e,r),!0)}}})),Zr=(Wr.privateExport,Wr.privateImport,Wr.publicExport,Wr.publicImport,Wr.autoImport,o(function(t){t.exports={privateExport:function(t){return{n:t.n.toBuffer(),e:t.e,d:t.d.toBuffer(),p:t.p.toBuffer(),q:t.q.toBuffer(),dmp1:t.dmp1.toBuffer(),dmq1:t.dmq1.toBuffer(),coeff:t.coeff.toBuffer()}},privateImport:function(t,e){if(!(e.n&&e.e&&e.d&&e.p&&e.q&&e.dmp1&&e.dmq1&&e.coeff))throw Error("Invalid key data");t.setPrivate(e.n,e.e,e.d,e.p,e.q,e.dmp1,e.dmq1,e.coeff)},publicExport:function(t){return{n:t.n.toBuffer(),e:t.e}},publicImport:function(t,e){if(!e.n||!e.e)throw Error("Invalid key data");t.setPublic(e.n,e.e)},autoImport:function(e,r){return!(!r.n||!r.e||(r.d&&r.p&&r.q&&r.dmp1&&r.dmq1&&r.coeff?(t.exports.privateImport(e,r),0):(t.exports.publicImport(e,r),0)))}}})),Jr=(Zr.privateExport,Zr.privateImport,Zr.publicExport,Zr.publicImport,Zr.autoImport,o(function(t){function e(t){t=t.split("-");for(var e="private",r={type:"default"},n=1;n<t.length;n++)if(t[n])switch(t[n]){case"public":case"private":e=t[n];break;case"pem":r.type=t[n];break;case"der":r.type=t[n]}return{scheme:t[0],keyType:e,keyOpt:r}}t.exports={pkcs1:Hr,pkcs8:Wr,components:Zr,isPrivateExport:function(e){return t.exports[e]&&"function"==typeof t.exports[e].privateExport},isPrivateImport:function(e){return t.exports[e]&&"function"==typeof t.exports[e].privateImport},isPublicExport:function(e){return t.exports[e]&&"function"==typeof t.exports[e].publicExport},isPublicImport:function(e){return t.exports[e]&&"function"==typeof t.exports[e].publicImport},detectAndImport:function(r,n,i){if(void 0===i){for(var o in t.exports)if("function"==typeof t.exports[o].autoImport&&t.exports[o].autoImport(r,n))return!0}else if(i){var s=e(i);if(!t.exports[s.scheme])throw Error("Unsupported key format");"private"===s.keyType?t.exports[s.scheme].privateImport(r,n,s.keyOpt):t.exports[s.scheme].publicImport(r,n,s.keyOpt)}return!1},detectAndExport:function(r,n){if(n){var i=e(n);if(t.exports[i.scheme]){if("private"===i.keyType){if(!r.isPrivate())throw Error("This is not private key");return t.exports[i.scheme].privateExport(r,i.keyOpt)}if(!r.isPublic())throw Error("This is not public key");return t.exports[i.scheme].publicExport(r,i.keyOpt)}throw Error("Unsupported key format")}}}})),Xr=(Jr.pkcs1,Jr.pkcs8,Jr.components,Jr.isPrivateExport,Jr.isPrivateImport,Jr.isPublicExport,Jr.isPublicImport,Jr.detectAndImport,Jr.detectAndExport,Ue._),Qr=Ue;return void 0===t.RSA_NO_PADDING&&(t.RSA_NO_PADDING=3),function(){function t(e,i,o){return this instanceof t?(Xr.isObject(i)&&(o=i,i=void 0),this.$options={signingScheme:n,signingSchemeOptions:{hash:"sha256",saltLength:null},encryptionScheme:r,encryptionSchemeOptions:{hash:"sha1",label:null},environment:Qr.detectEnvironment(),rsaUtils:this},this.keyPair=new Ir.Key,this.$cache={},Buffer.isBuffer(e)||Xr.isString(e)?this.importKey(e,i):Xr.isObject(e)&&this.generateKeyPair(e.b,e.e),void this.setOptions(o)):new t(e,i,o)}var e={node10:["md4","md5","ripemd160","sha1","sha224","sha256","sha384","sha512"],node:["md4","md5","ripemd160","sha1","sha224","sha256","sha384","sha512"],iojs:["md4","md5","ripemd160","sha1","sha224","sha256","sha384","sha512"],browser:["md5","ripemd160","sha1","sha256","sha512"]},r="pkcs1_oaep",n="pkcs1",i={private:"pkcs1-private-pem","private-der":"pkcs1-private-der",public:"pkcs8-public-pem","public-der":"pkcs8-public-der"};return t.prototype.setOptions=function(t){if((t=t||{}).environment&&(this.$options.environment=t.environment),t.signingScheme){if(Xr.isString(t.signingScheme)){var i=t.signingScheme.toLowerCase().split("-");1==i.length?-1<e.node.indexOf(i[0])?(this.$options.signingSchemeOptions={hash:i[0]},this.$options.signingScheme=n):(this.$options.signingScheme=i[0],this.$options.signingSchemeOptions={hash:null}):(this.$options.signingSchemeOptions={hash:i[1]},this.$options.signingScheme=i[0])}else Xr.isObject(t.signingScheme)&&(this.$options.signingScheme=t.signingScheme.scheme||n,this.$options.signingSchemeOptions=Xr.omit(t.signingScheme,"scheme"));if(!kr.isSignature(this.$options.signingScheme))throw Error("Unsupported signing scheme");if(this.$options.signingSchemeOptions.hash&&-1===e[this.$options.environment].indexOf(this.$options.signingSchemeOptions.hash))throw Error("Unsupported hashing algorithm for "+this.$options.environment+" environment")}if(t.encryptionScheme){if(Xr.isString(t.encryptionScheme)?(this.$options.encryptionScheme=t.encryptionScheme.toLowerCase(),this.$options.encryptionSchemeOptions={}):Xr.isObject(t.encryptionScheme)&&(this.$options.encryptionScheme=t.encryptionScheme.scheme||r,this.$options.encryptionSchemeOptions=Xr.omit(t.encryptionScheme,"scheme")),!kr.isEncryption(this.$options.encryptionScheme))throw Error("Unsupported encryption scheme");if(this.$options.encryptionSchemeOptions.hash&&-1===e[this.$options.environment].indexOf(this.$options.encryptionSchemeOptions.hash))throw Error("Unsupported hashing algorithm for "+this.$options.environment+" environment")}this.keyPair.setOptions(this.$options)},t.prototype.generateKeyPair=function(t,e){if(e=e||65537,0!=(t=t||2048)%8)throw Error("Key size must be a multiple of 8.");return this.keyPair.generate(t,e.toString(16)),this.$cache={},this},t.prototype.importKey=function(t,e){if(!t)throw Error("Empty key given");if(e&&(e=i[e]||e),!Jr.detectAndImport(this.keyPair,t,e)&&void 0===e)throw Error("Key format must be specified");return this.$cache={},this},t.prototype.exportKey=function(t){return t=i[t=t||"private"]||t,this.$cache[t]||(this.$cache[t]=Jr.detectAndExport(this.keyPair,t)),this.$cache[t]},t.prototype.isPrivate=function(){return this.keyPair.isPrivate()},t.prototype.isPublic=function(t){return this.keyPair.isPublic(t)},t.prototype.isEmpty=function(){return!(this.keyPair.n||this.keyPair.e||this.keyPair.d)},t.prototype.encrypt=function(t,e,r){return this.$$encryptKey(!1,t,e,r)},t.prototype.decrypt=function(t,e){return this.$$decryptKey(!1,t,e)},t.prototype.encryptPrivate=function(t,e,r){return this.$$encryptKey(!0,t,e,r)},t.prototype.decryptPublic=function(t,e){return this.$$decryptKey(!0,t,e)},t.prototype.$$encryptKey=function(t,e,r,n){try{var i=this.keyPair.encrypt(this.$getDataForEncrypt(e,n),t);return"buffer"!=r&&r?i.toString(r):i}catch(t){throw console.log(t),Error("Error during encryption. Original error: "+t)}},t.prototype.$$decryptKey=function(t,e,r){try{e=Xr.isString(e)?Buffer.from(e,"base64"):e;var n=this.keyPair.decrypt(e,t);if(null===n)throw Error("Key decrypt method returns null.");return this.$getDecryptedData(n,r)}catch(t){throw Error("Error during decryption (probably incorrect key). Original error: "+t)}},t.prototype.sign=function(t,e,r){if(!this.isPrivate())throw Error("This is not private key");var n=this.keyPair.sign(this.$getDataForEncrypt(t,r));return e&&"buffer"!=e&&(n=n.toString(e)),n},t.prototype.verify=function(t,e,r,n){if(!this.isPublic())throw Error("This is not public key");return n=n&&"buffer"!=n?n:null,this.keyPair.verify(this.$getDataForEncrypt(t,r),e,n)},t.prototype.getKeySize=function(){return this.keyPair.keySize},t.prototype.getMaxMessageSize=function(){return this.keyPair.maxMessageLength},t.prototype.$getDataForEncrypt=function(t,e){if(Xr.isString(t)||Xr.isNumber(t))return Buffer.from(""+t,e||"utf8");if(Buffer.isBuffer(t))return t;if(Xr.isObject(t))return Buffer.from(h(t));throw Error("Unexpected data type")},t.prototype.$getDecryptedData=function(t,e){return"buffer"==(e=e||"buffer")?t:"json"==e?JSON.parse(t.toString()):t.toString(e)},t}()});
//# sourceMappingURL=mini-rsa.common.js.map
